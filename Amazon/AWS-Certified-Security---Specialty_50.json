{"pageProps":{"questions":[{"id":"XpFZgNkKEJ7YxTM2tu9A","answers_community":["B (92%)","8%"],"url":"https://www.examtopics.com/discussions/amazon/view/2192-exam-aws-certified-security-specialty-topic-1-question-32/","answer":"B","exam_id":29,"answer_description":"","unix_timestamp":1562315880,"discussion":[{"content":"The answer should be B. We can achieve this using AWS Config.\nhttps://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-enabled.html\nhttps://docs.aws.amazon.com/config/latest/developerguide/iam-root-access-key-check.html","timestamp":"1632157200.0","upvote_count":"44","comment_id":"4062","poster":"Madura","comments":[{"poster":"senseikimoji","content":"This is correct, only the \"calls to create-api-key\" part is very ambiguous. Technically Config does not detect the call, but the result of the call.","comment_id":"222611","upvote_count":"2","timestamp":"1635467760.0"},{"poster":"lolcats","upvote_count":"3","content":"AFAIK, Config can't trigger a Lambda for remediation, only for rules.","comment_id":"78638","timestamp":"1633811460.0","comments":[{"upvote_count":"3","content":"It can...you ever used Aws config ? \n\nhttps://aws.amazon.com/about-aws/whats-new/2018/04/aws-config-adds-support-for-aws-lambda/#:~:text=You%20can%20now%20record%20configuration,timeout%20settings%2C%20and%20concurrency%20settings.","timestamp":"1634274060.0","comment_id":"113404","poster":"awssecuritynewbie"}]},{"upvote_count":"4","poster":"ideoignus","content":"AWS Config cannot be configured to watch API calls. While there are other ways to do parts of each, here with options provided: Answer should be C","comment_id":"535733","timestamp":"1643492460.0"}]},{"content":"Hi Guys, answer is C. Based on past experience with AWS exams, AWS really like to based questions on their blogs and article to see how updated you are. Below are 2 article that shows exactly where the answer is found. 80% of the PRO exam are now based on these articles. That's why it's so damn hard. C\nhttps://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/\nhttps://github.com/aws/Trusted-Advisor-Tools/tree/master/ExposedAccessKeys","timestamp":"1632908100.0","comment_id":"39997","poster":"donathon","comments":[{"upvote_count":"2","content":"I like your answer but trusted advisor cannot detect the creation of access keys on the root account only the presence of them in popular code repos. Additionally this alert is only available if you are on a support plan where as Config does allow for this.","timestamp":"1633658400.0","poster":"graesaunders","comment_id":"60981"},{"content":"This is incorrect. Check Madura's response and links above. Standard use-cases for Config.","upvote_count":"2","timestamp":"1638565860.0","comment_id":"493375","poster":"EricR17"},{"content":"Nope B is correct. AWS wants to use managed services as much as possible.\n\"Cloudtrail-enabled aws managed config rule checks whether AWS CloudTrail is enabled in your AWS account. Optionally, you can specify which S3 bucket, SNS topic, and Amazon CloudWatch Logs ARN to use.\"","poster":"Reza215r","upvote_count":"6","timestamp":"1633455300.0","comments":[{"upvote_count":"1","timestamp":"1635878520.0","comment_id":"415576","content":"If CloudTrail is disabled, how can CloudTrail create an event?","poster":"DahMac"},{"content":"AWS Config cannot be configured to watch API calls. While there are other ways to do parts of each, here with options provided: Answer should be C","comment_id":"535734","upvote_count":"2","timestamp":"1643492520.0","poster":"ideoignus"}],"comment_id":"54366"}],"upvote_count":"25"},{"timestamp":"1707697920.0","upvote_count":"1","content":"Selected Answer: B\nAWS Config managed rule to check on root access key if they exist.\nhttps://docs.aws.amazon.com/config/latest/developerguide/iam-root-access-key-check.html\n\nAnother AWS Config managed rule to check if CloudTrail is enabled.\nhttps://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-enabled.html\n\nOption B is correct.","poster":"Raphaello","comment_id":"1147748"},{"content":"B is incorrect, because you have to create custom config rule to check api call for root user create-api-key.","comment_id":"1102114","timestamp":"1703125980.0","upvote_count":"1","poster":"brpjp"},{"upvote_count":"1","comment_id":"1062314","timestamp":"1699124880.0","content":"Selected Answer: B\nB is correct.\nC would be better if there was not mentioned AWS trusted advisor, which makes the whole sentence wrong.","poster":"Ciara123456"},{"content":"Selected Answer: B\nAnswer should be B","comment_id":"1049984","poster":"ZZNZ","timestamp":"1697933520.0","upvote_count":"1"},{"timestamp":"1691681340.0","poster":"tonimrz","comment_id":"977835","upvote_count":"1","content":"Selected Answer: B\nConfig can trigger Lambdas for remediation apart from SSM. \nAlso Config is not watching API calls, it should watch for API logging de/activation so the answer is B."},{"content":"https://docs.aws.amazon.com/prescriptive-guidance/latest/patterns/automatically-re-enable-aws-cloudtrail-by-using-a-custom-remediation-rule-in-aws-config.html","timestamp":"1687980300.0","poster":"rohitkaryan","comment_id":"937073","upvote_count":"1"},{"comment_id":"932652","poster":"Green53","timestamp":"1687617120.0","upvote_count":"2","content":"Selected Answer: B\nI looked into C, there doesn't seem to be a Trusted Advisor check for root API keys:\nhttps://docs.aws.amazon.com/awssupport/latest/user/security-checks.html\n\nAWS Config is about automated tracking and remediation of uncompliant resources, but I wasn't sure it could track the api key creation.\n\nhttps://docs.aws.amazon.com/config/latest/developerguide/managed-rules-by-aws-config.html\n\nSuggests it can. AWS provide two managed rules:\niam-root-access-key-check\nmulti-region-cloudtrail-enabled or cloudtrail-security-trail-enabled\n\nSo this would be my choice."},{"timestamp":"1685882760.0","comment_id":"914601","upvote_count":"1","poster":"Robert0","content":"Selected Answer: B\nAnswer should be B"},{"timestamp":"1685365920.0","content":"Selected Answer: B\nTo ensure that CloudTrail remains enabled in your account, AWS Config provides the cloudtrail-enabled managed rule. If CloudTrail is turned off, the cloudtrail-enabled rule automatically re-enables it by using automatic remediation.\nSource: https://docs.aws.amazon.com/prescriptive-guidance/latest/patterns/automatically-re-enable-aws-cloudtrail-by-using-a-custom-remediation-rule-in-aws-config.html","poster":"CloudBourne","comment_id":"909421","upvote_count":"1"},{"timestamp":"1684450860.0","upvote_count":"1","content":"To detect and automatically remediate the incident, you could use AWS Config to create a config rule that detects when AWS CloudTrail is disabled, as well as any calls to the root user create-api-key. Then use a Lambda function to re-enable CloudTrail logs and deactivate the root API keys. B","poster":"ITGURU51","comment_id":"901548"},{"content":"B is correct. https://docs.aws.amazon.com/prescriptive-guidance/latest/patterns/automatically-re-enable-aws-cloudtrail-by-using-a-custom-remediation-rule-in-aws-config.html","comment_id":"884957","timestamp":"1682839980.0","poster":"matrpro","upvote_count":"1"},{"content":"Selected Answer: B\nAWS wants to use managed services. Config can check and remediate if the Cloud trail is stopped and lambda can start it. in B, I do know what can do Trusted advisor to start CT logging. This last service is more to check resource utilization and so on...","upvote_count":"1","poster":"matrpro","comment_id":"884954","timestamp":"1682839860.0"},{"poster":"gvramana","upvote_count":"1","content":"Question Keyword is \"detect and automatically remediate\", of CloudTrail disable & create API keys\nAWS config with lambda will does all these\nhttps://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-enabled.html","timestamp":"1679499060.0","comment_id":"847207"},{"comment_id":"841254","poster":"sp951","content":"Selected Answer: B\nIt would be B bc it says automatically","upvote_count":"1","timestamp":"1678989900.0"},{"upvote_count":"1","comment_id":"826144","poster":"peddyua","timestamp":"1677693720.0","content":"You can achieve the same thing both ways. B and C both can use lambda\n\nimport boto3\n\ndef lambda_handler(event, context):\n \n # Re-enable CloudTrail logs\n cloudtrail = boto3.client('cloudtrail')\n cloudtrail.start_logging(Name='my-cloudtrail')\n\n # Deactivate root API key\n iam = boto3.client('iam')\n iam.update_access_key(UserName='root', AccessKeyId='my-api-key', Status='Inactive')"},{"poster":"gtmnagalla","upvote_count":"1","timestamp":"1676726400.0","comment_id":"812998","content":"Selected Answer: C\nC is the answer because -> Trusted Advisor can detect the creation of root API keys, you can create a Lambda function that is triggered by a CloudWatch Events rule. This rule can be configured to trigger when Trusted Advisor detects the creation of root API keys. The Lambda function can then take remedial actions, such as disabling or deleting the newly created access key.\nB is not the answer because , to detect calls for the root user \"create-api-key\" CloudTrail logs is required to identify the creation of API keys by the root user. But in the question cloudtrail is disabled."},{"comment_id":"778478","timestamp":"1673922120.0","upvote_count":"1","poster":"Mamas","content":"Selected Answer: B\nB is the best option"},{"poster":"whichonce","timestamp":"1673120280.0","comment_id":"768869","content":"\"automatically remediate\" is totally about AWS Config. It should be B","upvote_count":"1"},{"upvote_count":"1","comment_id":"730969","content":"Selected Answer: C\nMonitor status change of Trusted Advisor:\nCloudwatch Events: https://morioh.com/p/25f37499c68b\nEventBridge: https://docs.aws.amazon.com/awssupport/latest/user/cloudwatch-events-ta.html\n\nPlus, the GitHub link posted by donathon","timestamp":"1669770120.0","poster":"awsmonkey"},{"timestamp":"1668213420.0","poster":"janvandermerwer","comment_id":"716401","upvote_count":"1","comments":[{"upvote_count":"1","poster":"janvandermerwer","comment_id":"716402","timestamp":"1668213720.0","content":"For cloudtrail portion of question: Associated config rule:\nhttps://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-enabled.html"}],"content":"Selected Answer: B\nB - Seems like the most likely option.\n\nSecurity Hub items:\nunderlying config rule: AWS Config rule: iam-root-access-key-check\nhttps://docs.aws.amazon.com/config/latest/developerguide/iam-root-access-key-check.html\nhttps://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html\n\n\n\n1.12 – Ensure no root user access key exists\nSeverity: Critical\n\nAWS Config rule: iam-root-access-key-check\n\nSchedule type: Periodic\n\nThe root user has complete access to all services and resources in an AWS account. Access keys provide programmatic access to a given account.\n\nCIS recommends that all access keys be associated with the root user be removed. Removing access keys associated with the root user limits vectors that the account can be compromised by. Removing the root user access keys also encourages the creation and use of role-based accounts that are least privileged."},{"content":"Correct answer is C. There is no rule like create-api-key in AWS config rule to monitor root API keys.","upvote_count":"3","comment_id":"710850","poster":"UserSwe","timestamp":"1667522340.0"},{"poster":"God2029","upvote_count":"2","comment_id":"700392","content":"This is a testable scenario. \nDone a multiple research on the aws config and trusted advisor capabilities. B doesn't talk about trusted advisor, instead it tries to accommodate the check using Aws config itself. donathon has posted a GitHub link in the comment that explains the orchestration of the exposed API key remediation using trusted advisor. After reading these materials, I vote for C.","timestamp":"1666310340.0"},{"timestamp":"1663580280.0","content":"Selected Answer: B\nB is right","comment_id":"673142","upvote_count":"1","poster":"Mr__"},{"timestamp":"1663309620.0","content":"Selected Answer: B\nwhenever something changes and is considered as a configuration that doesn't need to be changed, the answer is always aws config.","comment_id":"670535","upvote_count":"4","poster":"ceeee"},{"timestamp":"1662243480.0","content":"Selected Answer: B\nCannot be C, trusted advisor does not have such check, here is a list:\nAmazon EC2 instances with Microsoft SQL Server end of support\nAmazon EC2 instances with Microsoft Windows Server end of support\nAmazon EBS Public Snapshots\nAmazon RDS Public Snapshots\nAmazon RDS Security Group Access Risk\nAmazon Route 53 MX Resource Record Sets and Sender Policy Framework\nAmazon S3 Bucket Permissions\nAWS CloudTrail Logging\nAWS Lambda Functions Using Deprecated Runtimes\nAWS Well-Architected high risk issues for security\nCloudFront Custom SSL Certificates in the IAM Certificate Store\nCloudFront SSL Certificate on the Origin Server\nELB Listener Security\nELB Security Groups\nExposed Access Keys\nIAM Access Key Rotation\nIAM Password Policy\nIAM Use\nMFA on Root Account\nSecurity Groups – Specific Ports Unrestricted\nSecurity Groups – Unrestricted Access","upvote_count":"2","comment_id":"658821","poster":"Root_Access"},{"poster":"dcasabona","timestamp":"1659735540.0","content":"Selected Answer: B\nOption B: You can monitor cloud trail status with AWS Configcloudtrail-enabled rule just like @Madura described.\nThe problem with option C is the statement saying the monitor the root API key with Trusted Advisor check. It doesn't do it: https://docs.aws.amazon.com/awssupport/latest/user/security-checks.html","upvote_count":"2","comment_id":"643103"},{"comment_id":"614823","timestamp":"1654919940.0","upvote_count":"1","poster":"Andres123456","content":"Answer: B"},{"timestamp":"1652439120.0","content":"Answer is B, C mentioned lambda - should be config rules to remediate the problem https://docs.aws.amazon.com/config/latest/developerguide/remediation.html","poster":"Scunningham99","upvote_count":"1","comment_id":"601088"},{"timestamp":"1650367500.0","upvote_count":"1","comments":[{"upvote_count":"1","poster":"francisco_guerra","content":"Check the Madura links and AWS config contain that two rules one per root keys and logging is better and easier than cloudwatch I go with B","comment_id":"647260","timestamp":"1660577940.0"}],"poster":"fgg89","content":"I go with C. B was tempting but this link makes it quite clear:\n\nhttps://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/","comment_id":"588114"},{"upvote_count":"1","content":"Selected Answer: B\nB 1000%","timestamp":"1644526620.0","comment_id":"544870","poster":"ggx"},{"upvote_count":"3","content":"supporting C > https://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/","timestamp":"1636211160.0","comment_id":"462520","poster":"1awssec"},{"poster":"lmtony","content":"Answer : B.\nTHe question is about after incident occurred. -> Option C is mention about the best practice before incident occur","timestamp":"1635952680.0","comment_id":"449282","upvote_count":"1"},{"comment_id":"413571","upvote_count":"1","content":"B is correct. For who are concerned about C , you must read question clearly, C answer is \"separate Amazon Trusted Advisor check to automatically detect the creation of root API keys\". In this case, root user created access keys, not mention about root access key.","timestamp":"1635847140.0","poster":"Kdosec"},{"upvote_count":"1","comment_id":"403002","timestamp":"1635831300.0","poster":"skipbaylessfor3","content":"tough one, but I'm probably gonna go with B"},{"upvote_count":"2","timestamp":"1635799560.0","poster":"ShakthiVinu","comment_id":"397282","content":"my answer is C"},{"comment_id":"391691","poster":"sathishfiles","content":"https://aws.amazon.com/blogs/mt/monitor-and-notify-on-aws-account-root-user-activity/","timestamp":"1635748680.0","upvote_count":"1"},{"comment_id":"388721","content":"The answer should be B.\nBut aws config rule cant check for any api call, only the result of it with iam root access key check rule. \nWorst wording","upvote_count":"2","timestamp":"1635737460.0","poster":"rhinozD"},{"timestamp":"1635726240.0","upvote_count":"1","comment_id":"353834","poster":"sanjaym","content":"Ans: B 100%"},{"content":"B is Correct","upvote_count":"2","comment_id":"276060","timestamp":"1635554520.0","poster":"NANDY666"},{"upvote_count":"2","timestamp":"1635483420.0","comment_id":"235826","content":"Ans: B https://www.youtube.com/watch?v=PD9S5xGC16g watch the power of config pause the video at 1:37 read top right what config can, Cloudwatch can do the same but trusted advisor is spoiling it","poster":"Rayk"},{"content":"Ans > B","poster":"devjava","upvote_count":"1","comment_id":"221069","timestamp":"1635456120.0"},{"timestamp":"1635392880.0","comment_id":"207436","poster":"AfricanCloudGuru","content":"Ans (B)","upvote_count":"1"},{"upvote_count":"1","comment_id":"165399","timestamp":"1634659080.0","poster":"PeppaPig","content":"B is correct.\nC is wrong simply because Trusted Advisor cannot check nothing automatically. You need a Lambda or your own script to refresh TA checks at a regular basis"},{"upvote_count":"1","comment_id":"138780","content":"Its a tricky one, but i would still vouch for B.","poster":"Ishu_awsguy","timestamp":"1634636700.0"},{"comment_id":"123479","poster":"awssecuritynewbie","timestamp":"1634601240.0","upvote_count":"1","content":"The option of using create-api-key is valid statement in cli \n\nhttps://docs.aws.amazon.com/cli/latest/reference/apigateway/create-api-key.html"},{"content":"for those who choose D, \"create a new CloudTrail event that detects the deactivation of CloudTrail logs\" does this even make sense ? \"separate CloudTrail event \" is that possible ?","comment_id":"122405","timestamp":"1634556660.0","upvote_count":"2","poster":"foreverlate88"},{"timestamp":"1634343420.0","poster":"shikyo","comment_id":"119324","upvote_count":"1","content":"it's B, what doc could you give to affirme that trusted advisor can automatically trigger an action"},{"poster":"DK_M","upvote_count":"2","comment_id":"119164","timestamp":"1634309880.0","content":"From AWS Config Guide - Answer is B\nExample rule with configuration change and periodic triggers\n\nYou create a custom rule that evaluates whether CloudTrail trails in your account are turned on and logging for all regions.\n\nYou want AWS Config to run evaluations for the rule every time a trail is created, updated, or deleted. You also want AWS Config to run the rule every 12 hours.\n\nFor the trigger type, choose configuration changes and periodic."},{"comment_id":"100366","timestamp":"1634222520.0","upvote_count":"2","poster":"avinasht","content":"The correct answer is C. because it has two parts\n\nPart 1: check if cloudtrail is stopped or not, so cloudwatch events can be leveraged to perform this action and instruct lambda to perform re-enabling of cloudtrails\nHere's the reference: https://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/\n\nPart 2: is related to root keys. Use trusted advisor to check \"AUTOMATICALLY DECTECT CREATION OF ROOT API KEYS\". This is not remediation. I saw some comments that TA cannot remediate the keys things, Oviously it cannot but Lambda can do that.\n\nSo, to sum up, the answer is C"},{"poster":"RajeshNayyar","comment_id":"99531","timestamp":"1634183040.0","upvote_count":"1","content":"B is right, you can invokehttps://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_develop-rules_nodejs.htmllama function by custom rule in was config"},{"content":"Answer: B\nBoth B and C are decent answers.\nHowever, Trusted Advisor does not run continuously. Easy to check as when you visit the dashboard it identifies the last time a check was run. AWS Config on the other hand can trigger based on changes made to monitored resources (such as API calls), which could trigger a CloudWatch Event, then a Lambda function.\nIn the question the important statement is \"API keys that appear to have been used several times\". With AWS Config, a new key could be remediated/removed very quickly. With Trusted Advisor, it could take quite some time for any event to be picked up.","poster":"inf","timestamp":"1634058600.0","comment_id":"89855","upvote_count":"4"},{"content":"Answer is c. https://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/ And https://aws.amazon.com/blogs/mt/monitor-and-notify-on-aws-account-root-user-activity/","upvote_count":"2","comment_id":"89576","poster":"Puzzle","timestamp":"1633915920.0"},{"upvote_count":"1","timestamp":"1633802400.0","poster":"RaySmith","comment_id":"75249","content":"B is correct"},{"poster":"donathon","timestamp":"1633774980.0","upvote_count":"1","content":"https://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/\nhttps://github.com/aws/Trusted-Advisor-Tools/tree/master/ExposedAccessKeys\nA: AWS Inspector is for vulnerability scanning.\nB: To create root user access key the command is Create-access-key https://docs.aws.amazon.com/cli/latest/reference/iam/create-access-key.html \nD: How can you use a CloudTrail to detect it’s own disablement?","comment_id":"68261"},{"poster":"Muthiah","content":"Ans is C\nSee the second link ... TA detects new key generated\nHi Guys, answer is C. Based on past experience with AWS exams, AWS really like to based questions on their blogs and article to see how updated you are. Below are 2 article that shows exactly where the answer is found. 80% of the PRO exam are now based on these articles. That's why it's so damn hard. C\nhttps://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/\nhttps://github.com/aws/Trusted-Advisor-Tools/tree/master/ExposedAccessKeys","upvote_count":"3","comments":[{"timestamp":"1633774380.0","poster":"graesaunders","comment_id":"60983","content":"Wrong TA does not provide a link to it please the ExposedAccessKeys only checks for your keys in public repos not the creation of them..","upvote_count":"2"}],"timestamp":"1633618500.0","comment_id":"59873"},{"comments":[{"timestamp":"1633580280.0","comment_id":"58746","content":"Sorry ...Answer is D","poster":"Sriramps","upvote_count":"1"}],"comment_id":"53461","timestamp":"1633416360.0","content":"Answer is B\nYou can develop custom rules and add them to AWS Config. You associate each custom rule with an AWS Lambda function, which contains the logic that evaluates whether your AWS resources comply with the rule.\nhttps://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_develop-rules.html - Check AWS config custom rule","upvote_count":"1","poster":"Sriramps"},{"comment_id":"50857","timestamp":"1633367100.0","content":"Answer is B\nhttps://docs.aws.amazon.com/config/latest/developerguide/iam-root-access-key-check.html\nhttps://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-enabled.html","poster":"awsstudent","upvote_count":"1"},{"comment_id":"45660","timestamp":"1633179960.0","content":"Aws config will help u in that.","poster":"RakeshTaninki","upvote_count":"1"},{"upvote_count":"1","timestamp":"1632982920.0","content":"Correct Answer is D.\nMonitor Changes and Auto-Enable Logging in AWS CloudTrail\nhttps://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/\n\nMonitor and Notify on AWS Account Root User Activity\nhttps://aws.amazon.com/blogs/mt/monitor-and-notify-on-aws-account-root-user-activity/","comments":[{"upvote_count":"1","timestamp":"1633059780.0","content":"Option D, would be more clear if they have mentioned CloudWatch in it, like...\n\n\"...create a new CloudWatch event that detects the deactivation of CloudTrail logs, and a separate CloudWatch event that detects the creation of root API keys.\"","comment_id":"45152","poster":"learnaws16"},{"comment_id":"173607","content":"That link clearly says you create a CloudWatch Event, not a CloudTrail event. CloudTrail records data, it does not react to events.","timestamp":"1635154620.0","upvote_count":"1","poster":"freddyman"}],"poster":"learnaws16","comment_id":"45151"},{"upvote_count":"1","poster":"henry76","comment_id":"37595","content":"B is correct","timestamp":"1632862620.0"},{"poster":"AnNguyen","content":"I think about D\n\"detects the deactivation of CloudTrail logs\"\nCloudWatch cannot detect, it should be CloudTrail operational event\nFollow the link: https://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/\nThe word \"CloudTrail event\" could be CloudTrail operational events","comment_id":"35157","timestamp":"1632760560.0","upvote_count":"1"},{"timestamp":"1632657660.0","upvote_count":"1","poster":"AWSE","content":"B is the correct answer. \nEach custom Config rule is associated with an AWS Lambda function, which is custom code that contains the evaluation logic for the rule. When the trigger for a Config rule occurs (for example, when AWS Config detects a configuration change), AWS Config invokes the rule's Lambda function by publishing an event, which is a JSON object that provides the configuration data that the function evaluates.","comment_id":"23138"},{"poster":"Salmansh","upvote_count":"1","content":"Look like D to me.\nCloudTrail can detect StopLogging and changes to API calls across your AWS infrastructure.\n\nhttps://aws.amazon.com/blogs/mt/monitor-changes-and-auto-enable-logging-in-aws-cloudtrail/","timestamp":"1632623460.0","comments":[{"poster":"nikoo","upvote_count":"1","timestamp":"1632743460.0","content":"there is no cloudTrail event service in AWS","comment_id":"23223"},{"poster":"Bach999","timestamp":"1633296240.0","content":"According to this link, it says \"That change event gets detected by a CloudWatch Events rule\", not \"CloudTrail event\"\nAn IAM user makes changes to a CloudTrail trail.\nThat change event gets detected by a CloudWatch Events rule.\nThe rule triggers a Lambda function.\nThe function publishes the change event to an SNS topic.\nThe SNS topic sends the email to its subscribers.\nIf the change event was to disable logging, the function re-enables logging on that trail.","comment_id":"47501","upvote_count":"1"}],"comment_id":"22636"},{"timestamp":"1632567120.0","poster":"INASR","comment_id":"10814","content":"This question is very tricky, now A & D are definitely wrong, however, B & C are both valid and also both have wrong statements as well . If we take C , cloud watch is right since it is the only way to Auto invoke lamda as a target and enable cloudtrail and disable APi keys, however second part of the answer is specifyig trusted advisor to auto-check creation of root API keys which is wrong since TA checks for newly created IAM users and also check rotation of IAM access keys ,hence C is wrong . Now for B , it is true that AWS config has a managed rule that detects if cloudtrail is disabled , however the seocnd part saying AWS detects any calls to the root user create-api-key whihc is wrong , it does not do that, the other part of the answer is using Lamda whihc is wrong since AWS Config can not automatically invoke Lamda function except if it uses S3 to store the confguration log file and then S3 events will invoke lamda, so here we go , B is also wrong . The best of both answers is B for me personally .","upvote_count":"6","comments":[{"comments":[{"content":"As per the following documentation: You can use AWS Config to record configuration changes made to your API Gateway API resources and send notifications based on resource changes. \nhttps://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-config.html","upvote_count":"1","timestamp":"1634070060.0","comment_id":"96594","poster":"bLk"}],"comment_id":"13022","poster":"exams","timestamp":"1632581940.0","content":"For option B, Config doesn't monitor \"calls to the root user create-api-key\" .. B doesn't make sense to me.\nCloudtrail is good option.. see below cloudtrail FAQ.. Cloudtrail event wording is incorrect.. so bit confused\nQ: Can I turn CloudTrail Event History off for my account?\n\nFor any CloudTrail trails that you have created, you can stop logging or delete the trails which will also stop the delivery of account activity to the S3 bucket you had designated as part of your trail configuration as well as delivery to CloudWatch Logs if configured. Account activity for the past 90 days will still be collected and visible within the CloudTrail console and through the AWS CLI.","upvote_count":"1"}]},{"comment_id":"10193","timestamp":"1632553200.0","content":"B is the correct , use AWS Config","upvote_count":"3","poster":"ugreenhost"},{"timestamp":"1632301680.0","upvote_count":"2","content":"Answer is B. Using cloudtrail, and config.","comment_id":"9731","poster":"Osemk"},{"upvote_count":"3","timestamp":"1632232980.0","content":"B is Correct\"","poster":"BillyC","comment_id":"9640"},{"poster":"jchen","upvote_count":"3","comment_id":"7825","content":"B is correct","timestamp":"1632177780.0"},{"content":"B is the Answer","comment_id":"4949","upvote_count":"3","poster":"Wpcorgan","timestamp":"1632162900.0"},{"upvote_count":"4","comment_id":"3564","timestamp":"1632134520.0","poster":"sensor","content":"Could not find out how Amazon Trusted Advisor can automatically detect the creation of root API keys (it checks only creation of root access keys). \nFor me config makes more sense, since the rule for cloudtrail disabling exists. I think a custom rule with API Gateway trigger can be created."}],"topic":"1","timestamp":"2019-07-05 10:38:00","choices":{"A":"Using Amazon Inspector, review all of the API calls and configure the inspector agent to leverage SNS topics to notify security of the change to AWS CloudTrail, and revoke the new API keys for the root user.","C":"Using Amazon CloudWatch, create a CloudWatch event that detects AWS CloudTrail deactivation and a separate Amazon Trusted Advisor check to automatically detect the creation of root API keys. Then use a Lambda function to enable AWS CloudTrail and deactivate the root API keys.","D":"Using Amazon CloudTrail, create a new CloudTrail event that detects the deactivation of CloudTrail logs, and a separate CloudTrail event that detects the creation of root API keys. Then use a Lambda function to enable CloudTrail and deactivate the root API keys.","B":"Using AWS Config, create a config rule that detects when AWS CloudTrail is disabled, as well as any calls to the root user create-api-key. Then use a Lambda function to re-enable CloudTrail logs and deactivate the root API keys."},"question_id":246,"answer_ET":"B","question_images":[],"question_text":"During a recent internal investigation, it was discovered that all API logging was disabled in a production account, and the root user had created new API keys that appear to have been used several times.\nWhat could have been done to detect and automatically remediate the incident?","isMC":true,"answer_images":[]},{"id":"mix9SDfr9KGpuHmDk2p1","answer_ET":"C","timestamp":"2022-09-02 13:41:00","answer_description":"","unix_timestamp":1662118860,"url":"https://www.examtopics.com/discussions/amazon/view/79386-exam-aws-certified-security-specialty-topic-1-question-320/","answer_images":[],"question_id":247,"question_text":"A company wants to monitor the deletion of customer managed CMKs. A security engineer must create an alarm that will notify the company before a CM׀ is deleted. The security engineer has configured the integration of AWS CloudTrail with Amazon CloudWatch.\nWhat should the security engineer do next to meet this requirement?","choices":{"C":"Create an Amazon EventBridge (Amazon CloudWatch Events) rule to look for API calls of DisableKey and ScheduleKeyDeletion. Create an AWS Lambda function to send an Amazon Simple Notification Service (Amazon SNS) message to the company. Add the Lambda function as the target of the Eventbridge (CloudWatch Events) rule.","A":"Within AWS Key Management Service (AWS KMS), specify the deletion time of the key material during CMK creation. AWS KMS will automatically create a CloudWatch alarm.","D":"Create an Amazon Simple Notification Service (Amazon SNS) policy to look for AWS Key Management Service (AWS KMS) API calls of RevokeGrant and ScheduleKeyDeletion. Create an AWS Lambda function to generate the alarm and send the notification to the company. Add the Lambda function as the target of the SNS policy.","B":"Create an Amazon EventBridge (Amazon CloudWatch Events) rule to look for API calls of DeleteAlias. Create an AWS Lambda function to send an Amazon Simple Notification Service (Amazon SNS) message to the company. Add the Lambda function as the target of the Eventbridge (CloudWatch Events) rule."},"discussion":[{"timestamp":"1685802000.0","poster":"Toptip","upvote_count":"2","comment_id":"913659","content":"Selected Answer: C\nC is correct"},{"content":"ScheduleKeyDeletion is an operation in AWS Key Management Service that schedules the deletion of a KMS key. By default, AWS KMS applies a waiting period of 30 days, but you can specify a waiting period of 7-30 days. When this operation is successful, the key state of the KMS key changes to PendingDeletion and the key can’t be used in any cryptographic operations. C","upvote_count":"1","timestamp":"1683230940.0","poster":"ITGURU51","comment_id":"889632"},{"comment_id":"662721","content":"Selected Answer: C\nHere is an example in cloudtrail:\nhttps://docs.aws.amazon.com/kms/latest/developerguide/ct-schedule-key-deletion.html","upvote_count":"4","timestamp":"1662569460.0","poster":"Root_Access"},{"content":"C: https://docs.aws.amazon.com/prescriptive-guidance/latest/patterns/monitor-and-remediate-scheduled-deletion-of-aws-kms-keys.html","timestamp":"1662118860.0","comment_id":"657365","upvote_count":"3","poster":"MungKey"}],"isMC":true,"exam_id":29,"topic":"1","question_images":[],"answer":"C","answers_community":["C (100%)"]},{"id":"gKAl9rUT0GhebnYOKVeS","unix_timestamp":1662053880,"exam_id":29,"question_images":[],"timestamp":"2022-09-01 19:38:00","choices":{"D":"Use geolocation headers in CloudFront to deny the specific countries.","A":"Create an AWS WAF web ACL with an IP match condition to deny the countries' IP ranges. Associate the web ACL with the CloudFront distribution.","B":"Create an AWS WAF web ACL with a geo match condition to deny the specific countries. Associate the web ACL with the CloudFront distribution.","C":"Use the geo restriction feature in CloudFront to deny the specific countries."},"answer_images":[],"answer":"C","question_text":"A company runs a global ecommerce website that is hosted on AWS. The company uses Amazon CloudFront to serve content to its user base. The company wants to block inbound traffic from a specific set of countries to comply with recent data regulation policies.\nWhich solution will meet these requirements MOST cost-effectively?","url":"https://www.examtopics.com/discussions/amazon/view/79114-exam-aws-certified-security-specialty-topic-1-question-321/","topic":"1","answer_ET":"C","question_id":248,"discussion":[{"content":"Selected Answer: C\nC: https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-geo-restriction/","poster":"mh777","comment_id":"656507","timestamp":"1662053880.0","upvote_count":"7"},{"comment_id":"913661","timestamp":"1685802120.0","upvote_count":"1","content":"Selected Answer: C\nC - CF has this build-in feature.. don't need to use WAF for that","poster":"Toptip"},{"content":"Selected Answer: C\nGeo restriction is the right answer here for sure.","comment_id":"869862","poster":"G4Exams","upvote_count":"1","timestamp":"1681432980.0"},{"comment_id":"710501","timestamp":"1667480220.0","upvote_count":"1","poster":"HieuTT","content":"325 is the end question ??? While Database have 334 questions"}],"answers_community":["C (100%)"],"isMC":true,"answer_description":""},{"id":"u3wLyPzvndlQjWWrDeM7","question_id":249,"unix_timestamp":1662089100,"isMC":true,"answer":"BCF","exam_id":29,"question_text":"A security engineer receives an AWS abuse email message. According to the message, an Amazon EC2 instance that is running in the security engineer's AWS account is sending phishing email messages.\nThe EC2 instance is part of an application that is deployed in production. The application runs on many EC2 instances behind an Application Load Balancer. The instances run in an Amazon EC2 Auto Scaling group across multiple subnets and multiple Availability Zones.\nThe instances normally communicate only over the HTTP, HTTPS, and MySQL protocols. Upon investigation, the security engineer discovers that email messages are being sent over port 587. All other traffic is normal.\nThe security engineer must create a solution that contains the compromised EC2 instance, preserves forensic evidence for analysis, and minimizes application downtime.\nWhich combination of steps must the security engineer take to meet these requirements? (Choose three.)","answer_description":"","question_images":[],"answers_community":["BCF (100%)"],"answer_images":[],"choices":{"C":"Gather volatile memory from the compromised EC2 instance. Suspend the compromised EC2 instance from the Auto Scaling group. Then take a snapshot of the compromised EC2 instance.","A":"Add an outbound rule to the security group that is attached to the compromised EC2 instance to deny traffic to 0.0.0.0/0 and port 587.","E":"Move the compromised EC2 instance to an isolated subnet that has a network ACL that has no inbound rules or outbound rules.","D":"Take a snapshot of the compromised EC2 instance. Suspend the compromised EC2 instance from the Auto Scaling group. Then gather volatile memory from the compromised EC2 instance.","F":"Replace the existing security group that is attached to the compromised EC2 instance with a new security group that has no inbound rules or outbound rules.","B":"Add an outbound rule to the network ACL for the subnet that contains the compromised EC2 instance to deny traffic to 0.0.0.0/0 and port 587."},"answer_ET":"BCF","topic":"1","timestamp":"2022-09-02 05:25:00","discussion":[{"comments":[{"poster":"kujin","upvote_count":"3","comment_id":"900319","timestamp":"1684338480.0","content":"E: It's not possible to move an existing instance to another subnet, Availability Zone, or VPC. Instead, you can manually migrate the instance by creating a new Amazon Machine Image (AMI) from the source instance.\n\nhttps://repost.aws/knowledge-center/move-ec2-instance"}],"timestamp":"1662120240.0","content":"BCF\nA - Not correct - SG cannot add outbound rule to deny\nB - Correct - NACL to deny outbound\nC - Correct - Before suspending gather volatile memory, after suspending take snapshot\nD - Not Correct - Suspending before gathering volatile memory may clear the memory\nE - Can do but F is better option\nF - Correct - Isolate the EC2 instance","comment_id":"657390","poster":"MungKey","upvote_count":"9"},{"upvote_count":"1","poster":"Toptip","comment_id":"913669","timestamp":"1685802360.0","content":"Selected Answer: BCF\nB,C,F best combination"},{"poster":"ITGURU51","comment_id":"890005","timestamp":"1683287340.0","content":"In the real world, we can use the security group to isolate the endpoint. This question is a little tricky because using an NACL impacts the entire subnet not just the compromised endpoint. From a cyber security perspective, the best way to isolate the host is to add the instance to a security group with no rules. BCF","upvote_count":"2"},{"upvote_count":"1","content":"ı dont understand why not bce,e is better option ı think,","poster":"swolfgang","timestamp":"1681409580.0","comment_id":"869653"},{"content":"Selected Answer: BCF\nIn order of obvious:\n- C is CORRECT and D is INCORRECT. You can't dump RAM memory from a snapshot.\n- A is INCORRECT. No deny rules on Security Groups.\nNow, the tricky part. Between B, E and F, one must be wrong. Picking B, you get to protect a little bit your production environment, and between E and F, both basically do the same. But it's also true that, normally, you don't get to answer twice over the same resource in an AWS exam (in this case, NACL). And since E and F do the same thing, we should pick B and F.\n\nTherefore BCF, or at least it's what I've gathered from looking around and trying to make this. But I can see the reasoning behind CEF too. This is a complicated one with no clear answer.","poster":"Artaggedon","upvote_count":"1","comment_id":"835855","timestamp":"1678532280.0"},{"timestamp":"1673201460.0","content":"Selected Answer: BCF\nA - Not correct - SG cannot add outbound rule to deny\nD - Not Correct - Suspending before gathering volatile memory may clear the memory","upvote_count":"1","comment_id":"769689","poster":"sakibmas"},{"upvote_count":"4","timestamp":"1662217500.0","content":"Selected Answer: BCF\nhttps://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/infrastructure-domain-incidents.html.","poster":"sapien45","comment_id":"658603"},{"poster":"vbal","comment_id":"656919","content":"BCF....","upvote_count":"1","timestamp":"1662089100.0"}],"url":"https://www.examtopics.com/discussions/amazon/view/79256-exam-aws-certified-security-specialty-topic-1-question-322/"},{"id":"POlYNPAI3N5c56O0XRYi","exam_id":29,"isMC":true,"answers_community":["B (92%)","8%"],"answer_ET":"B","question_id":250,"question_text":"A development team recently deployed a Java application on a default AWS Elastic Beanstalk environment. The application is unable to connect to an Amazon S3 bucket that has a default configuration in the same account.\nWhat should a security engineer do to troubleshoot this issue?","timestamp":"2022-08-30 20:33:00","topic":"1","discussion":[{"upvote_count":"1","poster":"yorkicurke","content":"Selected Answer: B\nWhen Elastic Beanstalk launches EC2 instances for an environment, it assigns an IAM instance profile to those instances. This instance profile contains the permissions needed for the application code running on the instances to access AWS resources like S3.\n\nThe application \"code access\" -> is controlled via -> the instance profile, \nwhile Elastic Beanstalk's \"own operations\" -> are controlled via -> the service role.\n\nHope that's helpfull.","timestamp":"1703780460.0","comment_id":"1107957"},{"upvote_count":"2","comment_id":"920149","content":"Selected Answer: B\nCannot be 'D' because the default S3 bucket policy is accessible by the bucket owner. This does not mean it explicitly blocks a given instance profile role.","poster":"6_8ftwin","timestamp":"1686410340.0"},{"upvote_count":"1","poster":"Toptip","timestamp":"1685802480.0","content":"Selected Answer: B\nB is correct","comment_id":"913672"},{"content":"Selected Answer: D\nIn my opinion, it's D. The reason behind is that an Instance Profile, technically, cannot have permissions since it's more about an identity than an authorithation. The permissions are in the role, so the short description in the documentation is misleading.\n\nPlus, when you create an Elastic Beanstalk, both the instance profile and the role are created and, normally, in that process you add the permissions needed to the role. But what you don't get to check is if there's an explicit deny on the S3 for whatever reason. And it's true that S3 policies have more authority than IAM Roles, since ownership of the object is a thing.\n\nIt's an unfair question, but D is the one with more power.","poster":"Artaggedon","upvote_count":"1","comment_id":"835882","timestamp":"1678533480.0","comments":[{"poster":"Tofu13","upvote_count":"1","timestamp":"1685425980.0","comment_id":"909948","comments":[{"content":"OK, it's B because it says bucket with default configuration.","timestamp":"1686914100.0","comment_id":"925090","poster":"Tofu13","upvote_count":"1"}],"content":"As both B and D look right, i guess u are supposed to conclude that \"the S3 bucket policy allows access\" in answer D does not mean \"allow\" as in English (where it translates to \"does not deny)\" but \"allow\" as in a policy context where the two are different things."}]},{"poster":"sakibmas","timestamp":"1673243940.0","comment_id":"770067","upvote_count":"1","content":"Selected Answer: B\nTo access an S3 bucket from Elastic Beanstalk, verify that your AWS Identity and Access Management (IAM) instance profile is attached to an Amazon Elastic Compute Cloud (Amazon EC2) instance. The instance must have the correct permissions for Amazon S3. Then, confirm that your S3 bucket policy doesn't deny access to the role attached to your instance profile\nReference: https://aws.amazon.com/premiumsupport/knowledge-center/elastic-beanstalk-s3-bucket-instance/"},{"timestamp":"1672097820.0","comment_id":"757935","poster":"RameshAWS","content":"Selected Answer: B\nValidate permissions for your instance profile\nhttps://aws.amazon.com/premiumsupport/knowledge-center/elastic-beanstalk-s3-bucket-instance/","upvote_count":"3"},{"upvote_count":"3","poster":"sapien45","comment_id":"658612","timestamp":"1662218280.0","content":"Selected Answer: B\nTo access an S3 bucket from Elastic Beanstalk, verify that your AWS Identity and Access Management (IAM) instance profile is attached to an Amazon Elastic Compute Cloud (Amazon EC2) instance. The instance must have the correct permissions for Amazon S3. Then, confirm that your S3 bucket policy doesn't deny access to the role attached to your instance profile.\nhttps://aws.amazon.com/premiumsupport/knowledge-center/elastic-beanstalk-s3-bucket-instance/"},{"poster":"toolshedlol","comment_id":"658378","timestamp":"1662203940.0","content":"Selected Answer: B\n\"To access an S3 bucket from Elastic Beanstalk, verify that your AWS Identity and Access Management (IAM) instance profile is attached to an Amazon Elastic Compute Cloud (Amazon EC2) instance. The instance must have the correct permissions for Amazon S3. Then, confirm that your S3 bucket policy doesn't deny access to the role attached to your instance profile.\"\n\nthe same!","upvote_count":"1"},{"upvote_count":"2","comment_id":"654316","poster":"CuLeBrO","content":"As per the link shared in the proposed solution of this question, the answer is B.\n\nhttps://aws.amazon.com/premiumsupport/knowledge-center/elastic-beanstalk-s3-bucket-instance/ \n\n\"To access an S3 bucket from Elastic Beanstalk, verify that your AWS Identity and Access Management (IAM) instance profile is attached to an Amazon Elastic Compute Cloud (Amazon EC2) instance. The instance must have the correct permissions for Amazon S3. Then, confirm that your S3 bucket policy doesn't deny access to the role attached to your instance profile.\"","timestamp":"1661884380.0"}],"choices":{"C":"Confirm that the AWSElasticBeanstalkFullAccess managed policy is attached to the Elastic Beanstalk environment.","A":"Confirm that the Elastic Beanstalk service role has access to Amazon S3.","D":"Confirm that the S3 bucket policy allows access from the Elastic Beanstalk application ARN.","B":"Confirm that the Elastic Beanstalk instance profile has access to Amazon S3."},"url":"https://www.examtopics.com/discussions/amazon/view/78481-exam-aws-certified-security-specialty-topic-1-question-323/","answer_images":[],"unix_timestamp":1661884380,"answer":"B","answer_description":"","question_images":[]}],"exam":{"isImplemented":true,"provider":"Amazon","numberOfQuestions":509,"isMCOnly":false,"id":29,"name":"AWS Certified Security - Specialty","lastUpdated":"11 Apr 2025","isBeta":false},"currentPage":50},"__N_SSP":true}