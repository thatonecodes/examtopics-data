{"pageProps":{"questions":[{"id":"lr3Ry3m7rpxlcZSh4dyL","discussion":[{"content":"because deleting CMK has no immediate effect on the EC2 instance or the EBS volume. The reason is that Amazon EC2 is using the plaintext data key—not the CMK—to encrypt all disk I/O while the volume is attached to the instance.\n\nHowever, when the encrypted EBS volume is detached from the EC2 instance, Amazon EBS removes the plaintext key from memory. The next time the encrypted EBS volume is attached to an EC2 instance, the attachment fails, because Amazon EBS cannot use the CMK to decrypt the volume's encrypted data key","poster":"INASR","comment_id":"10925","timestamp":"1632507060.0","upvote_count":"50","comments":[{"comment_id":"474704","content":"Correct answer: A","upvote_count":"3","timestamp":"1636449660.0","poster":"dfranco76"}]},{"poster":"gft28","content":"I think Danao works for AWS lol","upvote_count":"30","timestamp":"1634169240.0","comment_id":"56583"},{"content":"How is A the answer?\nThis is not possible because the data is encrypted, and without the CMK, you cannot decrypt it.","upvote_count":"1","poster":"Deyemzy","timestamp":"1718402340.0","comment_id":"1230675"},{"content":"Selected Answer: A\nCorrect answer is A.\nWell explained by INASR.","upvote_count":"1","comment_id":"1148759","poster":"Raphaello","timestamp":"1707780360.0"},{"upvote_count":"1","poster":"ITGURU51","timestamp":"1681024980.0","content":"The answer is A because we need to take a snapshot to recover data from the encrypted EBS volume. The question states that the original encryption key for the encrypted volume has been deleted.","comment_id":"865339"},{"poster":"boooliyooo","timestamp":"1672237620.0","comment_id":"759935","upvote_count":"2","content":"Selected Answer: A\nofficial reference: https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html\n\"You perform an action that makes the KMS key unusable. This has no immediate effect on the EC2 instance or the EBS volume. Amazon EC2 is using the plaintext data key—not the KMS key—to encrypt all disk I/O while the volume is attached to the instance.\""},{"poster":"ritears41","comment_id":"639942","upvote_count":"1","timestamp":"1659250860.0","content":"Selected Answer: A\nCorrect answer: A"},{"poster":"fais1985","upvote_count":"1","comment_id":"432619","timestamp":"1636065420.0","content":"A is Correct : You schedule the CMK for deletion, which makes it unusable. This has no immediate effect on the EC2 instance or the EBS volume, because Amazon EC2 is using the plaintext data key—not the CMK—to encrypt disk I/O to the EBS volume."},{"timestamp":"1635720180.0","poster":"sanjaym","upvote_count":"1","comment_id":"354052","content":"Ans: A"},{"content":"Answer : A . data still in EBS volume. you should back it up before detaching","timestamp":"1635657240.0","upvote_count":"3","comment_id":"332754","poster":"durmusc"},{"comment_id":"284646","timestamp":"1635607440.0","poster":"NANDY666","upvote_count":"2","content":"A is Correct"},{"upvote_count":"1","comment_id":"219698","content":"Ans > A\nhttps://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html#deleting-keys-how-it-works","poster":"devjava","timestamp":"1635580560.0"},{"poster":"AfricanCloudGuru","content":"Ans (A)","timestamp":"1635438960.0","upvote_count":"2","comment_id":"211347"},{"timestamp":"1635365760.0","poster":"Ayusef","upvote_count":"3","comment_id":"207195","content":"That guy is Kimo with a different name now I promise. On another note thank you to all the technical fellows here. When I am in doubt you all always clear things up and I hope my post of real world use on some of the questions help also. Maybe one day we will have a technical guild like the middle ages."},{"content":"A, because the key will remain plain-text in the memory until the instance depatched","timestamp":"1635018840.0","upvote_count":"3","poster":"Dic","comment_id":"184473"},{"poster":"wzlinux","comment_id":"102800","upvote_count":"1","content":"I will go with A","timestamp":"1634224080.0"},{"comment_id":"90325","content":"A, for sure.","upvote_count":"1","timestamp":"1634219040.0","poster":"gfhbox0083"},{"upvote_count":"4","comment_id":"72440","poster":"CloudyMcClouderson","timestamp":"1634217300.0","content":"confirmation here: https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html#deleting-keys-how-it-works"},{"content":"A is correct","timestamp":"1633797720.0","upvote_count":"1","poster":"RakeshTaninki","comment_id":"45735"},{"upvote_count":"1","content":"A is the correct answer !","poster":"henry76","timestamp":"1633357980.0","comment_id":"42580"},{"upvote_count":"3","comments":[{"upvote_count":"21","comment_id":"33368","poster":"henry76","content":"This person is here to mis-lead people !","timestamp":"1633167660.0"},{"content":"WRONG. A IS THE ANSWER HERE.","upvote_count":"28","poster":"newbie2019","comments":[{"comments":[{"comments":[{"comments":[{"timestamp":"1652113260.0","content":"danao stop hating bro","upvote_count":"2","comment_id":"599152","poster":"catfish"},{"poster":"Balki","timestamp":"1670763840.0","content":"I too searched. AWS always rocks ;)","comment_id":"741713","upvote_count":"1"}],"poster":"MoreOps","content":"going to continue the chain, there is a 'danao works for AWS' comment near the top which intrigued me, anyone else who searched danao to get here leave a reply and say hi!","timestamp":"1650275280.0","upvote_count":"5","comment_id":"587587"}],"poster":"OhCobblers","comment_id":"177036","timestamp":"1634980980.0","content":"A fine and noble act of heroism against the dark side :)","upvote_count":"8"}],"timestamp":"1633218480.0","upvote_count":"21","poster":"ArizonaClassics","content":"NEWBIE YOU ARE CRACKING ME UP HUNTING THIS GUY DOWN","comment_id":"33808"}],"timestamp":"1633038000.0","comment_id":"27924"},{"comment_id":"439398","upvote_count":"5","content":"Seems Danao works for AWS to mislead peoples","timestamp":"1636192140.0","poster":"ExtHo"}],"comment_id":"21855","content":"D is correct","poster":"Danao","timestamp":"1632682140.0"},{"content":"EC2 keeps plain text key in memory while instance is running and this will allow to take data from ebs volume while it is attached to running instance. so option A would be right answer","poster":"examacc","timestamp":"1632628320.0","comment_id":"19291","upvote_count":"3"},{"upvote_count":"4","timestamp":"1632485700.0","poster":"INASR","content":"A is correct","comment_id":"10924"},{"content":"Yes A should be correct","upvote_count":"4","poster":"ugreenhost","timestamp":"1632212220.0","comment_id":"10147"},{"timestamp":"1632076920.0","comment_id":"10081","poster":"duduga40","upvote_count":"4","content":"A, is right?"}],"choices":{"B":"Recover the data from the EBS encrypted volume using an earlier version of the KMS backing key.","D":"Make a request to AWS Support to restore the deleted CMK, and use it to recover the data.","A":"Copy the data directly from the EBS encrypted volume before the volume is detached from the EC2 instance.","C":"Make a request to AWS Support to recover the S3 encrypted data."},"topic":"1","answer_images":[],"question_images":[],"answer":"A","timestamp":"2019-09-07 18:53:00","url":"https://www.examtopics.com/discussions/amazon/view/4863-exam-aws-certified-security-specialty-topic-1-question-103/","question_id":6,"unix_timestamp":1567875180,"answer_ET":"A","answer_description":"","answers_community":["A (100%)"],"isMC":true,"question_text":"A company stores data on an Amazon EBS volume attached to an Amazon EC2 instance. The data is asynchronously replicated to an Amazon S3 bucket. Both the EBS volume and the S3 bucket are encrypted with the same AWS KMS Customer Master Key (CMK). A former employee scheduled a deletion of that CMK before leaving the company.\nThe company's Developer Operations department learns about this only after the CMK has been deleted.\nWhich steps must be taken to address this situation?","exam_id":29},{"id":"efixqpG91rwoX2E2N6xo","isMC":true,"timestamp":"2019-09-07 18:53:00","answer_ET":"A","exam_id":29,"question_id":7,"unix_timestamp":1567875180,"url":"https://www.examtopics.com/discussions/amazon/view/4864-exam-aws-certified-security-specialty-topic-1-question-104/","choices":{"A":"The execution role for the Lambda function did not grant permissions to write log data to CloudWatch Logs.","B":"The Lambda function was executed by using Amazon API Gateway, so the logs are not stored in CloudWatch Logs.","D":"The version of the Lambda function that was executed was not current.","C":"The execution role for the Lambda function did not grant permissions to write to the Amazon S3 bucket where CloudWatch Logs stores the logs."},"question_images":[],"answers_community":["A (100%)"],"discussion":[{"timestamp":"1634292000.0","poster":"Sriramps","upvote_count":"31","content":"Answer is A\nYou can insert logging statements into your code to help you validate that your code is working as expected. Lambda automatically integrates with Amazon CloudWatch Logs. It pushes all logs from your code to a CloudWatch Logs group that is associated with a Lambda function (/aws/lambda/<function name>). To learn more about log groups and accessing them through the CloudWatch console, see Working with Log Groups and Log Streams in the Amazon CloudWatch Logs User Guide. For information about how to access CloudWatch log entries, see Accessing Amazon CloudWatch Logs for AWS Lambda.\n\nNote\nIf your Lambda function code is executing, but you don't see any log data being generated after several minutes, this could mean that your execution role for the Lambda function didn't grant permissions to write log data to CloudWatch Logs. For information about how to make sure that you have set up the execution role correctly to grant these permissions, see AWS Lambda Execution Role.\nhttps://docs.aws.amazon.com/lambda/latest/dg/lambda-monitoring.html","comment_id":"54426"},{"content":"B is incorrect. API calls are also logged in cloudtrail\nC is incorrect. Cloudwatch is the one that writes logs to S3, not the Lambda\nD is incorrect. Irrelevant","timestamp":"1632447600.0","upvote_count":"12","comment_id":"12909","poster":"josellama2000"},{"comment_id":"1148762","timestamp":"1707780660.0","upvote_count":"1","content":"Selected Answer: A\nCorrect Answer is A\nLambda execution role needs the following actions to be permitted.\n \"logs:CreateLogGroup\"\n \"logs:CreateLogStream\"\n \"logs:PutLogEvents\"","poster":"Raphaello"},{"timestamp":"1681025640.0","comment_id":"865345","upvote_count":"1","poster":"ITGURU51","content":"The lambda function's execution role must have sufficient permissions to write logs to CloudWatch."},{"poster":"Ell89","content":"Selected Answer: A\nanswer is A","comment_id":"828102","upvote_count":"1","timestamp":"1677858240.0"},{"timestamp":"1635362460.0","comment_id":"392216","upvote_count":"2","poster":"skipbaylessfor3","content":"Lol I've actually experienced this problem at work. I'm pretty sure the answer is A"},{"comment_id":"354053","timestamp":"1635153660.0","content":"Ans: A 100%","upvote_count":"2","comments":[{"poster":"MartNobel","comments":[{"content":"Exactly what I am thinking when I see every sanjaym's comment on that dump XD","timestamp":"1636264800.0","poster":"SoukelezArtibuz","upvote_count":"2","comment_id":"447584"}],"timestamp":"1635875040.0","comment_id":"407800","upvote_count":"2","content":"what a contribution!"}],"poster":"sanjaym"},{"upvote_count":"1","comment_id":"284647","poster":"NANDY666","content":"A is Correct","timestamp":"1634580120.0"},{"poster":"devjava","upvote_count":"1","timestamp":"1634547900.0","content":"Ans > A","comment_id":"219700"},{"timestamp":"1634411640.0","upvote_count":"1","poster":"AfricanCloudGuru","comment_id":"211348","content":"Ans (A)\n\nhttps://docs.aws.amazon.com/lambda/latest/dg/lambda-monitoring.html"},{"content":"A, for sure.\nWe can log API calls in CloudWatch logs.\nTo help debug issues related to request execution or client access to your API, you can enable Amazon CloudWatch Logs to log API calls.\nhttps://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-logging.html","upvote_count":"1","poster":"gfhbox0083","timestamp":"1634328300.0","comment_id":"90326"},{"timestamp":"1634170980.0","poster":"RakeshTaninki","upvote_count":"1","comment_id":"45736","content":"A is correct"},{"comment_id":"42584","upvote_count":"1","content":"A and B looks correct !","timestamp":"1633617480.0","poster":"henry76"},{"poster":"quehant","comment_id":"41237","content":"Nobody votes for B? The lambda already altered the data, and it is asking who invoked and what was altered. So I think it should be in cloudtrail","timestamp":"1633332540.0","upvote_count":"2"},{"upvote_count":"1","comment_id":"27925","timestamp":"1633089240.0","content":"A is the answer.","poster":"newbie2019"},{"poster":"INASR","timestamp":"1632377880.0","comment_id":"10926","content":"A is right","upvote_count":"1"},{"upvote_count":"2","timestamp":"1632281100.0","content":"Out of the 4 options, A seems to be the most possible","comment_id":"10148","poster":"ugreenhost"},{"comment_id":"10082","upvote_count":"7","poster":"duduga40","timestamp":"1632141360.0","content":"A, is right?"}],"answer_description":"Reference:\nhttps://docs.aws.amazon.com/lambda/latest/dg/troubleshooting.html","question_text":"An AWS Lambda function was misused to alter data, and a Security Engineer must identify who invoked the function and what output was produced. The Engineer cannot find any logs created by the Lambda function in Amazon CloudWatch Logs.\nWhich of the following explains why the logs are not available?","answer_images":[],"answer":"A","topic":"1"},{"id":"GtPiyvei8lMMRx81q2YN","exam_id":29,"topic":"1","choices":{"A":"GuardDuty did not have the appropriate alerts activated.","D":"GuardDuty does not report on command-and-control activity.","B":"GuardDuty does not see these DNS requests.","C":"GuardDuty only monitors active network traffic flow for command-and-control activity."},"url":"https://www.examtopics.com/discussions/amazon/view/4865-exam-aws-certified-security-specialty-topic-1-question-105/","answer_ET":"B","discussion":[{"poster":"examacc","comments":[{"poster":"John129087","comment_id":"477326","content":"B definitely. DNS logs do not work for 3rd party DNS resolver including Active Directory Servers. Think about why they had to mention Windows and AD","timestamp":"1636786740.0","upvote_count":"2"},{"content":"It is C not B . See Guardduty FAQ \"Amazon GuardDuty does not manage or retain your logs. All data consumed by GuardDuty is analyzed in near real-time and discarded\" . Also there is not 3rd party DNS mentioned here Ref: https://www.amazonaws.cn/en/guardduty/faqs/","comment_id":"368928","upvote_count":"6","timestamp":"1635925860.0","poster":"Gustava6272","comments":[{"comment_id":"521106","poster":"f4bi4n","content":"Its B, as the IP check for C&C uses VPC Flow logs and even a blocked entry would be included there. \nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html#backdoor-ec2-ccactivityb","timestamp":"1641845400.0","upvote_count":"1"}]}],"timestamp":"1633479780.0","upvote_count":"50","comment_id":"20479","content":"Answer is B: As per AWS\nDNS logs\nIf you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source."},{"comment_id":"12910","comments":[{"comment_id":"415725","poster":"DahMac","upvote_count":"1","timestamp":"1636183320.0","content":"C. GuardDuty only monitors active network traffic flow for command-and-control activity. Nothing else? no attacks? Don't think so.\n\"GuardDuty analyzes tens of billions of events across multiple AWS data sources, such as AWS CloudTrail, Amazon VPC Flow Logs, and DNS logs. With a few clicks in the AWS Management Console, GuardDuty can be enabled with no software or hardware to deploy or maintain.\""},{"content":"it is B or C? or the options shuffled \nB. GuardDuty does not see these DNS requests.\nC. GuardDuty only monitors active network traffic flow for command-and-control activity.","upvote_count":"2","poster":"exams","comment_id":"13635","timestamp":"1632972120.0","comments":[{"content":"B\nGuard duty do monitor the C&C activity: Backdoor:EC2/C&CActivity.B!DNS\n\nDefault severity: High\n\nFinding description\n\nEC2 instance is querying a domain name that is associated with a known command and control server.\n\nThe reason it can’t see is it’s using on premise AD dns which guardduty is not able to scan.","timestamp":"1633428000.0","poster":"EricJason","upvote_count":"12","comment_id":"15330"}]}],"timestamp":"1632872460.0","content":"A is incorrect. It could be correct if traffic to the malicious IP happened, but this is not the case. You can set severity values for alerts.\nC is correct.\nGuardDuty monitor DNS traffic for data exfiltration, not for regualr resolves.\nSince the communication with the malicious server failed, no connections were made to the malicious IP for GuardDuty to detect.\nB is incorrect, same reason as on C\nD is incorrect. GuardDuty supose to detect traffic to malicious IPs","upvote_count":"9","poster":"josellama2000"},{"comment_id":"1148764","upvote_count":"1","poster":"Raphaello","timestamp":"1707781140.0","content":"Selected Answer: B\nCorrect answer is B.\nWindows instances joined AD, and therefore use its DNS instead of Route53 resolver, while GuardDuty relies on DNS query logs to detect such flow.\n\nBackdoor:EC2/C&CActivity.B!DNS\nAn EC2 instance is querying a domain name that is associated with a known command and control server\nDefault severity: High\n Data source: DNS logs <<<<<<<<"},{"timestamp":"1686406140.0","comment_id":"920122","poster":"OCHT","content":"Selected Answer: B\noption C. \"GuardDuty only monitors active network traffic flow for command-and-control activity\" could be misleading because GuardDuty can also analyze other types of traffic and activities, such as CloudTrail logs and S3 data events, not just active network traffic flow.","upvote_count":"1"},{"upvote_count":"1","content":"Selected Answer: B\nit is B","comment_id":"885734","timestamp":"1682902740.0","poster":"vavofa5697"},{"content":"DNS logs\nIf you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source.","comment_id":"865065","timestamp":"1680988440.0","poster":"ITGURU51","upvote_count":"1"},{"timestamp":"1647050400.0","content":"It has to be Route53 DNS for GuardDuty to see DNS. Other DNS resolvers wont work.","upvote_count":"2","comment_id":"565893","poster":"tezawynn"},{"upvote_count":"1","content":"Selected Answer: B\nif DNS resolvers are not using Route 53 so GuardDuty cannot detect malicious communication to C2C","timestamp":"1646406660.0","comment_id":"560854","poster":"mx677"},{"content":"B is correct \nwhen using active directory the DNS resolution is done by the domain controller and guardduty only works with R53 only for dns resolution.","comment_id":"538350","timestamp":"1643770560.0","upvote_count":"4","poster":"alghoundar"},{"comment_id":"534327","timestamp":"1643339220.0","upvote_count":"1","content":"B. GuardDuty does not see these DNS requests.","poster":"Radhaghosh"},{"comment_id":"436205","poster":"Elva","timestamp":"1636281120.0","content":"Ans: B . Look at question -> GuardDuty does not see THESE DNS requests. (these dns point to special case with these dns request.) Also quote: \"EC2 instances in a VPC that are joined to on-premises Active Directory servers for domain services\". Does this mean that is uses DNS from this domain server (and not AWS DNS). So B for me.","upvote_count":"1"},{"poster":"Ponzy","timestamp":"1636065420.0","comment_id":"385511","upvote_count":"1","content":"Answer is CCCCCCCC\nA general search explains the following:\nWhat can GuardDuty detect?\nThe service uses machine learning, anomaly detection, and integrated threat intelligence to identify and prioritize potential threats. GuardDuty analyzes tens of billions of events across multiple AWS data sources, such as AWS CloudTrail event logs, Amazon VPC Flow Logs, and DNS logs.\nSurely, those who vote for B need to consider facts of GuardDuty in relation to DNS logs. the statement in B is a naked lie."},{"content":"The question is poorly written. I agree the right answer is A but mainly because the rest of the answers can be ruled out. However GuardDuty detects C&C activity not only by inspecting DNS resolution, but also by having a look at VPC Flow logs. That means that even if you are not able inspect the DNS because you are using a third party one, GuardDuty will see the ip address of the C&C server and will be able to alert on that.","upvote_count":"1","timestamp":"1635904620.0","comment_id":"348528","poster":"johnsm"},{"comment_id":"219705","poster":"devjava","content":"Ans > B\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html#guardduty_dns","upvote_count":"4","timestamp":"1635833460.0"},{"timestamp":"1635749220.0","poster":"AfricanCloudGuru","upvote_count":"1","content":"Ans(C)\nAWS Guard Duty only monitors active network","comment_id":"211353"},{"content":"B\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html#guardduty_dns\nIf you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source.","timestamp":"1635677220.0","comment_id":"190747","poster":"Mr_Zaw","upvote_count":"1"},{"comment_id":"157931","content":"B should be the right answer, Guard duty can't see the dns requests from 3rd party domain services.","timestamp":"1635579840.0","upvote_count":"2","poster":"sunilrch"},{"upvote_count":"2","poster":"JackLee1","comment_id":"155130","timestamp":"1635567120.0","content":"Pretty confusing question.\nI am assuming that the server is using only domain DNS server as it is joined to the domain and not using AWS DNS. Hence, GuardDuty cannot see the DNS requests and cannot alert.\nThe question next states that the requests to C&C are failing. That could be 1) because the requests are getting blocked at proxy which may be in place. 2) Or some other inline network appliance in place to block such requests. I am not 100% sure if VPC flow log is going to see this data.\n\nIf we assume that the request to C&C IP did go out, but maybe nothing at that IP is now live, hence a reqeust timeout happened so no active flow. I could not find anything in documentation stating it only monitors for active network flow or for all traffic which would include only SYN requests as well which never got an ACK.\n\nSo, B is correct as well as C. Maybe the actual question would have more clarity."},{"upvote_count":"2","content":"B is the correct answer, as Guard duty only see DNS queries which resolve to internal DNS servers. Take a look at below article at amazon site. \n\"If you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source.\" \nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html\n\nSince here you are using your own DNS server on prem , so Guard duty doesn't s have access to those logs.","timestamp":"1635325560.0","comment_id":"137952","poster":"USA_JAAT"},{"content":"It's definitely B - Guard Duty can only process DNS logs from AWS DNS servers. Based on the Guard Duty User Guide, \"If you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source.\"\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty-ug.pdf","comment_id":"124429","upvote_count":"2","poster":"awscertguy","timestamp":"1634983680.0"},{"comment_id":"102859","upvote_count":"1","poster":"wzlinux","timestamp":"1634945820.0","content":"C is correct"},{"upvote_count":"2","timestamp":"1634839800.0","comment_id":"88605","content":"\"\"\"\"on-premises Active Directory servers\"\"\"\". -- DNS LOGS CANT BE READ BY GAURD DUTY FOR ON-PREMISES AD","comments":[{"upvote_count":"2","poster":"AnilL","timestamp":"1634860680.0","comment_id":"88607","content":"ON-PREMESIS DOMAIN SERVERS"}],"poster":"AnilL"},{"comment_id":"69700","upvote_count":"5","timestamp":"1634766660.0","content":"To further the point for B.\nto further the point.. look up Trojan:EC2/DGADomainRequest.B\nFinding description\nEC2 instance is querying algorithmically generated domains. Such domains are commonly used by malware and could be an indication of a compromised EC2 instance.\nThis finding informs you that there is an EC2 instance in your AWS environment that is trying to query domain generation algorithms (DGA) domains. Your EC2 instance might be compromised.\n\nNote\nThis finding is based on analysis of domain names using advanced heuristics, and hence may identify new DGA domains that are not present in Threat Intelligence feeds.\n\nDGAs are used to periodically generate a large number of domain names that can be used as rendezvous points with their command and control (C&C) servers. C&C servers are computers that issue commands to members of a botnet,\nBasically without DNS these would not be identified even if it did communicate successfully to the the C&C, in essence GuardDuty would be Blind to recognize a unknown new C&C\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html","poster":"simplimarvelous"},{"upvote_count":"5","timestamp":"1634672580.0","comment_id":"69696","content":"IT is B.\n1) the attempt to communicate with the C&C server is failing so C. is valid but its not the base reason\n2) because the EC2s are using on-prem AD they are using DNS outside of AWS, when EC2 is using AD on Prem, Amazon-provided DNS is used only for public DNS resolution, but \nSince Amazon-provided DNS cannot be used to provide name resolution services for Active Directory, to make it work you'll need to ensure that domain-joined Windows instances have been configured to use Active Directory DNS.","poster":"simplimarvelous"},{"content":"Ans is b, guardduty only checks the logs of dns logs, clodfront logs, vpc flowlogs, alb flowlogs.","timestamp":"1634512380.0","poster":"RakeshTaninki","upvote_count":"5","comments":[{"timestamp":"1634656680.0","comment_id":"45893","poster":"cbueller","upvote_count":"5","content":"If you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source."}],"comment_id":"45737"},{"poster":"AnNguyen","content":"Answer is B\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html","upvote_count":"4","timestamp":"1634134680.0","comment_id":"35785"},{"comments":[{"timestamp":"1634231040.0","poster":"viral65","upvote_count":"10","content":"Wrong again.Its waste of counting.Report spam is only option","comments":[{"content":"but B is correct what you on about man","upvote_count":"3","poster":"awssecuritynewbie","comment_id":"102623","timestamp":"1634888400.0"},{"timestamp":"1635557460.0","comment_id":"138265","poster":"samviz","content":"now i will count u","upvote_count":"1"}],"comment_id":"35832"}],"comment_id":"21860","timestamp":"1633991160.0","content":"B is correct","poster":"Danao","upvote_count":"3"},{"comment_id":"10927","timestamp":"1632634560.0","content":"C is correct","poster":"INASR","upvote_count":"1"},{"poster":"mojoa","comments":[{"comment_id":"15328","poster":"EricJason","timestamp":"1633324320.0","content":"So the answer should be B, why you say C?","upvote_count":"3"}],"timestamp":"1632538860.0","content":"It MAY be c.\nhttps://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html\nDNS logs\n\nIf you use AWS DNS resolvers for your EC2 instances (the default setting), then GuardDuty can access and process your request and response DNS logs through the internal AWS DNS resolvers. If you are using a 3rd party DNS resolver, for example, OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, then GuardDuty cannot access and process data from this data source.","comment_id":"10607","upvote_count":"5"},{"content":"C or D, anybody?","comment_id":"10229","timestamp":"1632502560.0","poster":"duduga40","upvote_count":"1"},{"upvote_count":"1","comment_id":"10149","content":"i think D is correct","poster":"ugreenhost","timestamp":"1632453480.0"},{"content":"C, is right?","timestamp":"1632178920.0","comment_id":"10083","poster":"duduga40","upvote_count":"1"}],"isMC":true,"answer_description":"","question_id":8,"question_text":"A company has Windows Amazon EC2 instances in a VPC that are joined to on-premises Active Directory servers for domain services. The security team has enabled Amazon GuardDuty on the AWS account to alert on issues with the instances.\nDuring a weekly audit of network traffic, the Security Engineer notices that one of the EC2 instances is attempting to communicate with a known command-and- control server but failing. This alert does not show up in GuardDuty.\nWhy did GuardDuty fail to alert to this behavior?","timestamp":"2019-09-07 18:53:00","answer":"B","question_images":[],"answers_community":["B (100%)"],"answer_images":[],"unix_timestamp":1567875180},{"id":"QdYmbHM2jZSIgJ9Rp0Zn","choices":{"D":"Add lambda.amazonaws.com as a trusted entity on the IAM role that the Lambda function uses.","B":"Update the Lambda configuration to launch the function in a VPC.","C":"Add a policy to the role that the Lambda function uses, allowing kms: Decrypt for the KMS key.","A":"Update the ssm.amazonaws.com principal in the KMS key policy to allow kms: Decrypt."},"answers_community":["C (100%)"],"answer_images":[],"answer":"C","answer_description":"","exam_id":29,"unix_timestamp":1567622880,"timestamp":"2019-09-04 20:48:00","topic":"1","discussion":[{"comment_id":"12912","upvote_count":"43","poster":"josellama2000","comments":[{"comment_id":"13636","poster":"exams","content":"Agree. C is correct\nBoth encrypted and plaintext parameter values are stored with only the Lambda function having permissions to decrypt the secrets.","timestamp":"1632547800.0","upvote_count":"9","comments":[{"comment_id":"38204","upvote_count":"3","poster":"cloudprincipal","timestamp":"1633372800.0","content":"Agree, C is correct"}]}],"timestamp":"1632494400.0","content":"A ssm (System Manager) has nothing to do with the question\nB is irrelevant. Lambdas run on their own VPC\nC is correc.t\nD is incorrect. Irrelevant. Trusted entity is the entity allowed to assume a IAM role. It is the principal of the role"},{"content":"Trying to bring my contribution to this topic\nAs per this link this is how you create an IAM policy to access AWS KMS \n{\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n {\n \"Effect\": \"Allow\",\n \"Action\": [\n \"kms:Decrypt\",\n ],\n \"Resource\": \"arn:aws-cn:kms:<region>:<123456789012>:key/<key-ID>\"\n }\n ]\n}\nThen you can save your policy and assign it to the IAM role you will create after that for the lambda function\nhttps://docs.amazonaws.cn/en_us/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Integrating.Authorizing.IAM.KMSCreatePolicy.html\nSo answer C makes sense to me too\nMerry xmas ;)","poster":"johndoe","timestamp":"1632967440.0","upvote_count":"22","comment_id":"32555"},{"upvote_count":"1","content":"Selected Answer: C\nLambda execution role needs to have permission to use KMS key (kms:Decrypt).\n\nCorrect answer is C","poster":"Raphaello","comment_id":"1148766","timestamp":"1707781200.0"},{"upvote_count":"1","timestamp":"1685309820.0","content":"The correct answer is C because the Lambda function needs the decrypt permission to perform the task.","poster":"ITGURU51","comment_id":"908880"},{"timestamp":"1671399540.0","upvote_count":"1","content":"Selected Answer: C\nIt is a testable scenario. Answer is C.","poster":"awsmonkey","comment_id":"749209"},{"content":"Selected Answer: C\nWhen Secrets Manager uses a KMS key in cryptographic operations, it acts on behalf of the user who is accessing or updating the secret value","upvote_count":"2","timestamp":"1669731180.0","comment_id":"730491","poster":"hubekpeter"},{"timestamp":"1654630800.0","comment_id":"612909","content":"Selected Answer: C\nC is correct","upvote_count":"2","poster":"lotfi50"},{"poster":"ashmek","upvote_count":"1","comment_id":"594945","content":"C is the correct answer from other sites as well.","timestamp":"1651312920.0"},{"poster":"Kdosec","comment_id":"399794","upvote_count":"1","content":"The answer A is not correct but the attached link below answer is correct.\nhttps://aws.amazon.com/blogs/compute/sharing-secrets-with-aws-lambda-using-aws-systems-manager-parameter-store/\n\nThe link guide that Lambda policy need to allow access key, not related to SSM.","timestamp":"1636241040.0"},{"timestamp":"1636063260.0","comment_id":"323693","upvote_count":"2","poster":"Larsson","content":"C I say is correct here. The Lambda execution role needs getparameter and decrypt. SSM itself is not the principal. Right?"},{"content":"2 ways to fix this:\n- Add a policy to allow the Lambda function's execution role to Decrypt the CMK (Option C)\n- Add Lambda's function's execution role to the \"key users\"","poster":"Huy","upvote_count":"1","timestamp":"1636044420.0","comment_id":"322539"},{"poster":"Ghostbusters","timestamp":"1635904080.0","comment_id":"254215","content":"This is another tricky one. Here is how we should think about it. Firstly, it is easy to dismiss B and D. B is complete BS, and D is not so much, as whatever D states must be true for the Lambda to even run. As the question states that the Lambda ran, so D can be dismissed. Left with A and C. Here is the fundamental knowledge needed: If a compute actor is trying to retrieve an encrypted key from SSM, does that Compute actor need the permission to access (specifically decrypt) the CMK, or does SSM need it? Answer is: the compute actor. KMS key policy provide does provide an alternative to this, which is the \"ViaService\" condition. But if we are using ViaService, then ssm.amazonaws.com will be specified not as the Principal, but as the ViaService. Hence, the correct answer is C, not A.","upvote_count":"7"},{"content":"In AWS Identity and Access Management (IAM), you can grant or deny a service access to resources using the Principal policy element. The Principal policy element value for Systems Manager is ssm.amazonaws.com.","poster":"Melymel","comment_id":"249848","upvote_count":"1","timestamp":"1635889620.0"},{"content":"Ans > C","timestamp":"1635503580.0","upvote_count":"1","poster":"devjava","comment_id":"219720"},{"upvote_count":"1","comment_id":"211354","poster":"AfricanCloudGuru","timestamp":"1635421380.0","content":"Ans (A)\nhttps://aws.amazon.com/blogs/compute/sharing-secrets-with-aws-lambda-using-aws-systems-manager-parameter-store/","comments":[{"content":"Please your answer and the link doesn't match","comment_id":"446993","poster":"HananS","timestamp":"1636277820.0","upvote_count":"1"}]},{"comment_id":"207285","upvote_count":"2","timestamp":"1635372840.0","content":"Dano is Kimo..","poster":"Ayusef"},{"content":"Ans is C, clearly mentioned here https://docs.aws.amazon.com/kms/latest/developerguide/services-parameter-store.html","poster":"Dic","comment_id":"184492","upvote_count":"2","timestamp":"1635304260.0"},{"comments":[{"upvote_count":"1","timestamp":"1634876580.0","comment_id":"162387","poster":"PeppaPig","content":"So C is the only correct answer. If the question was about using the SSM default KMS key, then none of the answer is correct"}],"poster":"PeppaPig","upvote_count":"1","content":"A bit dive deep:\nThe description mentions that SSM uses a KMS key that allows control through IAM. This indicates that the key used here is a Customer managed CMK. To permit access to a Customer managed CMK, you can use either key policies or key policies in combination with IAM policies. When IAM policies is used, you need to add KMS:Decrypt to allow a service or an IAM to decrypt the secure parameter using the same KMS CMK (Likewise it also requires KMS:Encrypt in order to put a secure parameter in SSM)\n\nOn the other hand, you cannot manage the access control of an AWS managed CMK through IAM, and the SSM default KMS key is an AWS managed CMK. So If you use the SSM default KMS key with alias \"aws/ssm\" to put/get secure parameters, you don't need any additional KMS permissions in your IAM policies since you are actually using KMS via SSM.\nIf you are interested to learn more, just go create a SSM default CMK and go through its key policies","timestamp":"1634845920.0","comment_id":"162385"},{"content":"C is correct. You need to add KMS:Decrypt permission in your Lambda execution role","poster":"PeppaPig","timestamp":"1634762460.0","comment_id":"162338","upvote_count":"1"},{"upvote_count":"1","content":"my understanding is that SSM parameter doing the decrypt and not Lamda funtion? doesn't option A look correct?","comment_id":"156322","timestamp":"1634740560.0","poster":"Hita"},{"content":"I will go with C","poster":"wzlinux","upvote_count":"1","timestamp":"1634378820.0","comment_id":"102898"},{"comment_id":"97085","comments":[{"upvote_count":"2","content":"so far all you got is correct man!","poster":"Dic","timestamp":"1635288600.0","comment_id":"184491"}],"timestamp":"1634075760.0","content":"I had this question on my exam today. Correct answer is C","poster":"hozefa","upvote_count":"5"},{"poster":"Zhongkai","upvote_count":"1","timestamp":"1633855860.0","content":"The blog metioned - Principal:\n AWS: !GetAtt ParameterStoreBlogFunctionRoleDev.Arn\n Action:\n - 'kms:Encrypt'\n - 'kms:Decrypt'\n,which means the role Lambda is using will need \"decrypt\".\nThe answer should be C.","comment_id":"71316"},{"poster":"RakeshTaninki","content":"C is correct","comment_id":"45738","upvote_count":"1","timestamp":"1633572900.0"},{"poster":"AnNguyen","timestamp":"1633038480.0","comment_id":"35790","content":"Answer is C\nhttps://docs.amazonaws.cn/en_us/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Integrating.Authorizing.IAM.KMSCreatePolicy.html","upvote_count":"2"},{"timestamp":"1632798300.0","comment_id":"21863","poster":"Danao","upvote_count":"1","content":"A is correct","comments":[{"content":"Danao you are just trolling man.","comment_id":"76145","upvote_count":"4","timestamp":"1634053140.0","poster":"xaccan"},{"timestamp":"1632914100.0","content":"WRONG. EXAMTOPICS TEAM, CAN YOU PLEASE DELETE ALL COMMENTS FROM THIS USER? HE IS TRYING TO ADD CONFUSION TO THE THREADS.","comment_id":"27928","poster":"newbie2019","comments":[{"content":"Yeah, maybe he is doing it for confusion but it is for us to dig deeper and check if it is really correct or not. Don’t mind him and don’t get stressed by this Danao user.","upvote_count":"4","timestamp":"1634076720.0","poster":"samCarson","comment_id":"97616"},{"comment_id":"177041","upvote_count":"1","timestamp":"1635150540.0","content":"We can always learn from anything...\nMaybe let it was over you like a wave over an immovable rock. and...\nappreciate who entertaining dumb people can be :)\n\nThanks for the active input!","poster":"OhCobblers"}],"upvote_count":"32"}]},{"comment_id":"19757","timestamp":"1632728580.0","poster":"Rim007","content":"i'll go with c","upvote_count":"1"},{"comment_id":"19585","poster":"examacc","upvote_count":"1","content":"c is correct as lambda needs to have decryption access","timestamp":"1632705840.0"},{"upvote_count":"2","poster":"Sri_Tecky_Brains","timestamp":"1632568080.0","comment_id":"15681","content":"C is Correct."},{"comment_id":"10929","upvote_count":"2","poster":"INASR","timestamp":"1632395160.0","comments":[{"timestamp":"1632475620.0","upvote_count":"1","comment_id":"12067","content":"no,A is not correct, it's lambda as principle to decrypt the key and get valume from SSM.","poster":"EricJason","comments":[{"upvote_count":"1","poster":"ugreenhost","timestamp":"1632489780.0","content":"whats your ans on this EricJason??","comment_id":"12711"}]},{"poster":"rip72","comment_id":"222650","content":"I cannot find the principal mentioned in ssm.amazonaws.com format anywhere in this article & have never seen it in this format anywhere at all, so I would eliminate A. C looks correct because the role used by Lambda needs permission to decrypt.","timestamp":"1635700320.0","upvote_count":"1"}],"content":"A is correct for sure https://aws.amazon.com/blogs/compute/sharing-secrets-with-aws-lambda-using-aws-systems-manager-parameter-store/"},{"timestamp":"1632303720.0","poster":"duduga40","comment_id":"10084","content":"A, I think..","upvote_count":"1"},{"upvote_count":"2","comments":[{"upvote_count":"1","content":"no man it is wrong","comment_id":"64051","timestamp":"1633621800.0","poster":"awssecuritynewbie"}],"timestamp":"1632136800.0","poster":"BillyC","content":"A I think... what do you think?","comment_id":"9651"}],"url":"https://www.examtopics.com/discussions/amazon/view/4710-exam-aws-certified-security-specialty-topic-1-question-106/","question_images":[],"question_text":"The AWS Systems Manager Parameter Store is being used to store database passwords used by an AWS Lambda function. Because this is sensitive data, the parameters are stored as type SecureString and protected by an AWS KMS key that allows access through IAM. When the function executes, this parameter cannot be retrieved as the result of an access denied error.\nWhich of the following actions will resolve the access denied error?","question_id":9,"answer_ET":"C","isMC":true},{"id":"hDxAmbma93sx3y5AfIEU","timestamp":"2019-09-07 18:56:00","question_id":10,"question_images":[],"answer_description":"","question_text":"A company's security policy requires that VPC Flow Logs are enabled on all VPCs. A Security Engineer is looking to automate the process of auditing the VPC resources for compliance.\nWhat combination of actions should the Engineer take? (Choose two.)","answer":"AE","answer_images":[],"answers_community":["AE (82%)","DE (18%)"],"isMC":true,"topic":"1","unix_timestamp":1567875360,"choices":{"D":"Create an Amazon CloudWatch Event rule that triggers on events emitted by AWS Config.","E":"Create an AWS Config custom rule, and associate it with an AWS Lambda function that contains the evaluating logic.","C":"Create an AWS Config managed rule with a resource type of AWS:: Lambda:: Function.","A":"Create an AWS Lambda function that determines whether Flow Logs are enabled for a given VPC.","B":"Create an AWS Config configuration item for each VPC in the company AWS account."},"exam_id":29,"answer_ET":"AE","url":"https://www.examtopics.com/discussions/amazon/view/4866-exam-aws-certified-security-specialty-topic-1-question-107/","discussion":[{"upvote_count":"24","content":"D & E; \nthree steps are necessary (https://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/)\n1. Create a Lambda function containing the logic to determine if a resource is compliant or noncompliant.\n2. Create a custom Config rule that uses the Lambda function created in Step 1 as the source.\n3. Create a Lambda function that polls Config to detect noncompliant resources on a daily basis and send notifications via Amazon SNS.\nA -> 1\nD -> 3\nE -> 2 & 1\nsince E \"associate it with an AWS Lambda function that contains the evaluating logic\" covers A, ans is D&E","timestamp":"1634089260.0","poster":"Aws2222","comments":[{"content":"Correction: Ans A&E\nA-> 3\nE -> 2 & 1","timestamp":"1634377140.0","comment_id":"147296","poster":"Aws2222","comments":[{"content":"Grrr my bad. There should be two Lambda function in the process. therefore it seems A&E in first look. However my first answer is right. Both A and Lambda function in E refer to Step 1. There is a mechanism to read config rule poll as input and create notifications accordingly. There is no such lambda functions in the answers. But D can work for this. Final decision: D&E","comment_id":"147302","upvote_count":"5","timestamp":"1634557320.0","poster":"Aws2222"}],"upvote_count":"6"}],"comment_id":"64602"},{"poster":"josellama2000","timestamp":"1632785280.0","comments":[{"comment_id":"13638","content":"I think...\nCustom config rule - E\nalert - D","upvote_count":"3","timestamp":"1633022340.0","poster":"exams"},{"poster":"Smartphone","timestamp":"1633161300.0","content":"A and C are correct. Well explained on the above link.","comment_id":"16348","upvote_count":"1"},{"content":"custom rule is E, C is managed rule.","poster":"chaudh","comment_id":"17672","upvote_count":"1","timestamp":"1633372380.0"},{"comment_id":"28588","timestamp":"1633531620.0","poster":"s3an","content":"I think some answers were switched ....with this link and your comment, answer should be AE now","upvote_count":"8"},{"poster":"henry76","upvote_count":"14","timestamp":"1633581480.0","comments":[{"content":"Agree: A and E are correct","timestamp":"1633808460.0","comment_id":"38205","poster":"cloudprincipal","upvote_count":"8"}],"comment_id":"33364","content":"2) create a custom Config rule and use the Lambda function (ARN) as the source (Is option E)\nthen the answer is A and E"}],"comment_id":"12913","content":"A & C are correct for sure. The link shows an exact situation.\n1) Create a Lambda function containing the logic to determine if VPC is enable or disable (Answer A)\n2) create a custom Config rule and use the Lambda function (ARN) as the source (Answer C)\n3) Create a Lambda function that polls Config to detect noncompliant resources on a daily basis and send notifications via Amazon SNS\nhttps://medium.com/mudita-misra/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules-2e53b09006de","upvote_count":"8"},{"timestamp":"1707781440.0","comments":[{"poster":"Raphaello","upvote_count":"1","timestamp":"1708962060.0","comment_id":"1159891","content":"It is worth to mention that there's a managed rule for AWS Config called \"vpc-flow-logs-enabled\" (Resource Types: AWS::EC2::VPC), and in real life you do not need to create your own logic function to check on this configuration.\n\nBut in this question, it was not mentioned and the best options out of the provided 5 are A and E."}],"upvote_count":"1","poster":"Raphaello","comment_id":"1148767","content":"Selected Answer: AE\nCorrect answers are AE"},{"poster":"Shinytopology","timestamp":"1688568720.0","comments":[{"timestamp":"1703508540.0","comment_id":"1105280","poster":"yorkicurke","upvote_count":"1","content":"yeah and that rule is vpc-flow-logs-enabled."}],"comment_id":"943857","content":"Seems question is outdated. AWS Config had a managed rule checking if all VPC flow log has been enabled. https://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html","upvote_count":"7"},{"comment_id":"878216","upvote_count":"3","poster":"Dmosh","content":"We have a managed config rule for this:\nhttps://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html","timestamp":"1682246220.0"},{"poster":"Nikhil0222","content":"AE \nOption A is correct because the Security Engineer can create an AWS Lambda function that uses the AWS SDK to determine whether Flow Logs are enabled for a given VPC by checking the status of the Flow Logs on the VPC. The function can be triggered on a schedule using a CloudWatch Event rule.\n\nOption E is correct because the Security Engineer can create an AWS Config custom rule that uses the same AWS Lambda function created in Option A. The custom rule can evaluate each VPC in the account and check the status of the Flow Logs on the VPC. If the Flow Logs are not enabled, the rule can return a noncompliant result. The Security Engineer can then use AWS Config to aggregate and view the compliance status of all VPCs in the account","upvote_count":"1","timestamp":"1681337760.0","comment_id":"868845"},{"upvote_count":"1","comment_id":"865646","timestamp":"1681056000.0","poster":"ITGURU51","content":"This is a two step solution. First we need to create the Lambda function with the logic to evaluate the VPC flow logs. Next we need to create a Custom Config rule and associate it with the Lambda function. Therefore the answer is A and E."},{"comment_id":"741704","content":"Selected Answer: AE\nhttps://aws.amazon.com/blogs/mt/how-to-enable-vpc-flow-logs-automatically-using-aws-config-rules/ talks about solution without Lambda. So, Lambda can also be used instead of System manager","poster":"Balki","upvote_count":"2","timestamp":"1670763300.0"},{"upvote_count":"1","poster":"cloud_collector","timestamp":"1663325280.0","comment_id":"670708","content":"Selected Answer: AE\n1.Create a Lambda function containing the logic to determine if a resource is compliant or noncompliant.\n2.Create a custom Config rule that uses the Lambda function created in Step 1 as the source.\n3.Create a Lambda function that polls Config to detect noncompliant resources on a daily basis and send notifications via Amazon SNS.\nhttps://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/"},{"content":"Selected Answer: DE\nI go with D and E","upvote_count":"1","poster":"dcasabona","comment_id":"638882","timestamp":"1659043560.0"},{"comment_id":"628413","timestamp":"1657209660.0","upvote_count":"3","content":"Selected Answer: AE\nA & E, you need a custom rule in AWS config and a lambda function to check it","poster":"gofavad926"},{"timestamp":"1656945420.0","content":"my answer is D,E","upvote_count":"1","comment_id":"627037","poster":"jackfei"},{"timestamp":"1649889360.0","poster":"TigerInTheCloud","content":"Selected Answer: DE\nSurely E which includes the action in A with D is a kind of remediation.\nHowever, there is a better answer to this quest now. There is a managed rule \"vpc-flow-log-enabled\" and an AWS managed document \"AWS-EnableVPCFlowLogs\"","upvote_count":"2","comment_id":"585441"},{"timestamp":"1647800940.0","upvote_count":"2","comment_id":"571787","content":"Selected Answer: AE\nA,E - c0rect","poster":"ceros399"},{"timestamp":"1646801580.0","comment_id":"563752","upvote_count":"2","content":"Selected Answer: AE\nI was confused at the highest voted one, but from what others say in the comments ,it seems like since they answered the answered were mixed up and switched places,\nAE is the right for me","poster":"MoreOps"},{"timestamp":"1644228660.0","content":"Selected Answer: AE\nThe answer is A & E","comment_id":"542271","upvote_count":"3","poster":"lotfi50"},{"poster":"sam_live","upvote_count":"4","comment_id":"528544","content":"First of all the question doesn't mention about alerting but only auditing. So option D CloudWatch doesn't come into picture. \nA & E should be the answers if we follow this blog. \nhttps://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/","timestamp":"1642692840.0"},{"upvote_count":"2","poster":"HPCloud","content":"Why not B? We can use rule check if VPC flow log enabled for VPC in account. then cloudwatch event can be configured to detect","timestamp":"1637999160.0","comment_id":"487955"},{"comment_id":"399321","poster":"EricR17","timestamp":"1636284420.0","upvote_count":"4","content":"Answer: A&E\n\nhttps://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/"},{"upvote_count":"4","timestamp":"1636105740.0","content":"A&E - \"is looking to automate the process of auditing the VPC resources for compliance\"\nSince there is no mention nor correct answer with managed rule (C is completely wrong - resource is VPC, not Lambda) you have to recreate the process.\nA - write a Lambda function that checks VPC\nE - create a custom rule that runs the Lambda you have written\nAs said:\nC - wrong\nB - first there is no configuration item, second rule doesn't have to be assigned to each VPC it can run for ALL VPCs in the account\nD - CloudWatch is out of scope, Config manages everything if you want to manage remediation you just assign another Lambda that will handle necessary changes","poster":"DerekKey","comment_id":"381043"},{"comments":[{"content":"Revisiting. A & E make more sense.","comment_id":"375306","upvote_count":"3","timestamp":"1635998280.0","poster":"eskimolander"}],"timestamp":"1635859500.0","content":"For ALL VPCs. A does and E do not fullfill this requisite. There is a managed rule in AWS Config that can be used and which would be displayed in Amazon Cloudwatch. B says for each VPC. So B and D are correct.","comment_id":"352500","poster":"eskimolander","upvote_count":"1"},{"comment_id":"349547","content":"This is another question coming from an exam that unfortunately is not showing the best possible solution. Correct answers are A & E, but there is a better way to do this using a native AWS Config rule that checks if VPC flow logs are enabled https://docs.aws.amazon.com/es_es/config/latest/developerguide/vpc-flow-logs-enabled.html So creating a lambda function for this is not even needed...","comments":[{"upvote_count":"2","timestamp":"1636108440.0","comment_id":"381545","poster":"itsjustalife","content":"yep, i am thinking the same. The native AWS config rule already check whether VPC flow log is enabled."}],"upvote_count":"5","timestamp":"1635777840.0","poster":"johnsm"},{"comment_id":"332782","poster":"durmusc","timestamp":"1635712080.0","content":"Answer : A& E\nclearly explained : https://medium.com/mudita-misra/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules-2e53b09006de","upvote_count":"3"},{"poster":"Larsson","content":"B and D, I say it's pretty obvious. You don't use Lambda for auditing (you would use Lambda for performing services tasks like terminating something but that isn't auditing).","comment_id":"323696","upvote_count":"1","timestamp":"1635594060.0"},{"content":"Taking a step back, this question seems to have been designed BEFORE this canned Config check was made GA: https://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html. Thinking of how someone would do this today, they will simply use this canned rule, no need to write a custom rule. But thinking of when this question was designed, and assuming that a custom rule is needed, E and A is the best answer in that case. It hurts to think that the exam expects us to KNOW all 100+ Config checks, but even if it does not expect, we can always pretend that the check does not exist, and choose A and E, the answer should be marked correct, as there is no option to use a canned rule. Why am I dismissing the rest of the options? Because (1) Config rules are never applied to \"each\" VPC, they are always applied to a class of resources (2) Though using CloudWatch Events to notify based on Config Events is a good solution, there is no \"pair\" solution to that option in this question (3) The question strictly asks about \"auditing\", not remediating","comment_id":"254232","upvote_count":"2","poster":"Ghostbusters","timestamp":"1635345180.0"},{"poster":"shooricg","content":"its A & E. you need to create a custom managed Config rule for this. and when you create a custom config rule, the rule needs to be executed and evaluated by a lambda. man these questions are tricky!","comment_id":"232131","timestamp":"1635323700.0","upvote_count":"2"},{"poster":"kalzht00","upvote_count":"1","timestamp":"1635253080.0","content":"Seems A & E , but not 100% sure though ... :(","comment_id":"225966"},{"comment_id":"219779","upvote_count":"1","timestamp":"1635210180.0","content":"In here we need to find out what are the resources in the VPC. That can be evaluate by using the aws config rule against the compliance rule \nAns B and D","poster":"buddhika2010"},{"upvote_count":"3","poster":"devjava","content":"Ans > A,E\nhttps://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_develop-rules.html\n\nC is wrong as you cannot trigger an Lambda from an AWS Managed Rule, you will need a Custom Rule to do so\n\nYou can develop custom rules and add them to AWS Config. You associate each custom rule with an AWS Lambda function, which contains the logic that evaluates whether your AWS resources comply with the rule.","timestamp":"1635066480.0","comment_id":"219735"},{"content":"Ans (B, D)","timestamp":"1635045840.0","comment_id":"211355","upvote_count":"1","poster":"AfricanCloudGuru"},{"timestamp":"1634941860.0","poster":"Ayusef","upvote_count":"1","comment_id":"207291","content":"It is A and E"},{"upvote_count":"1","content":"B and D. \nhttps://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html\nas per above link, AWS config has identifier to check VPC flowlog is enabled or not. Then another logical answer is to send config log to CloudWatch for to trigger alarm.","poster":"Mr_Zaw","timestamp":"1634889900.0","comment_id":"198293"},{"upvote_count":"4","poster":"Calvinaud","content":"I think the answer is A & E.\nB and C are out of the question.\nFor D, the question ask only for the auditing part and nothing else. D answer is needed when you want notification etc.\nThe answer are badly written (in my opinion) but the idea is:\nA --> what type of evaluation logic in the lambda function\nE --> the process to link to AWS Config","comment_id":"188948","timestamp":"1634783640.0"},{"timestamp":"1634591820.0","comment_id":"162395","content":"My take is D&E\nAutomation is the key word, And to automate the entire process, you need two steps:\n1) A AWS Config rule to evaluate if VPC logs is enabled in each VPC, Since there no managed rule in Config, you need to create your own Lambda function with evaluation logics and associate the function with a customer rule. \nE is correct here\n2) Be able to get alerts when the compliance check fails. You can add a CW event with the config rule as the event source, and SNS topic as the target to get alerts through emails\nD is correct here","poster":"PeppaPig","comments":[{"poster":"Skywalker2","timestamp":"1634700960.0","upvote_count":"2","content":"A and E, D is not neeted, Config can be used to invoke a lambda function which in turn checks if flow logs are enabled for all vpcs\nCurrently the additional overhead of having a lambda function itself is not there. Config itself has built in rule\nhttps://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html","comment_id":"176873"}],"upvote_count":"1"},{"content":"AE is the right answer guys..\nhttps://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/","upvote_count":"3","timestamp":"1634587980.0","poster":"sunilrch","comment_id":"158904"},{"timestamp":"1634571000.0","upvote_count":"1","poster":"JackLee1","content":"For the managed rule, the resource type entry in the choice is incorrect. Here is the cloudformation template of the config managed rule - http://s3.amazonaws.com/aws-configservice-us-east-1/cloudformation-templates-for-managed-rules/VPC_FLOW_LOGS_ENABLED.template\n\nBy rule of negation\nB incorrect - makes no sense here\nC incorrect - as explained above\nD incorrect - makes no sense here\n\nSo the remaining are correct\nA - Create the lambda function to check whether flow logs are enabled or not\nE - Create the custom rule and map the lambda function to it.","comment_id":"155148"},{"content":"Aand E for sure","poster":"Ishu_awsguy","timestamp":"1634310900.0","comment_id":"141282","upvote_count":"3"},{"comment_id":"109515","upvote_count":"1","content":"DE \nQuestion: \"automate the process of auditing\"\nOption A: \"for a *GIVEN* VPC\"\nSurely must be DE","poster":"Th3Dud3","timestamp":"1634241240.0"},{"comment_id":"102910","timestamp":"1634230140.0","content":"AE is the correct answer","poster":"wzlinux","upvote_count":"1"},{"comment_id":"77217","comments":[{"poster":"Dic","upvote_count":"1","comment_id":"184495","content":"100% correct","timestamp":"1634711340.0"}],"timestamp":"1634215860.0","upvote_count":"3","content":"A&E\nhttps://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/","poster":"Securityguru"},{"upvote_count":"3","content":"Ans A & E \nYou can develop custom rules and add them to AWS Config. You associate each custom rule with an AWS Lambda function, which contains the logic that evaluates whether your AWS resources comply with the rule.\nhttps://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_develop-rules.html","comment_id":"76414","poster":"echoes007","timestamp":"1634133240.0"},{"poster":"[Removed]","content":"A&E works!","timestamp":"1633962720.0","comments":[{"upvote_count":"2","poster":"SriN","comment_id":"58332","content":"A & E is correct - \nhttps://aws.amazon.com/blogs/security/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules/","comments":[{"upvote_count":"1","content":"Sorry D & E , A Custom Rule with Lambda logic which checks if VPC flow logs are enabled or not> \nThen a CloudWatch event scheduled to trigger SNS to send alerts.","poster":"SriN","comment_id":"58339","timestamp":"1634061420.0"}],"timestamp":"1634013420.0"}],"upvote_count":"3","comment_id":"53033"},{"content":"Ae as per old update","comment_id":"45739","timestamp":"1633948200.0","upvote_count":"1","poster":"RakeshTaninki"},{"comment_id":"43014","content":"This question may be old. There is now a managed config rule that does this. Is this question asked on the exam?\n\nhttps://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html","upvote_count":"3","timestamp":"1633897860.0","poster":"connorhoehn"},{"upvote_count":"3","content":"Answer is A,E now\nhttps://medium.com/mudita-misra/how-to-audit-your-aws-resources-for-security-compliance-by-using-custom-aws-config-rules-2e53b09006de","poster":"AnNguyen","comment_id":"35797","timestamp":"1633773120.0"},{"timestamp":"1633511760.0","poster":"Danao","comment_id":"21864","content":"B, D are correct","upvote_count":"2"},{"upvote_count":"2","poster":"L2007","content":"AE is IHMO the correct ans","comment_id":"21821","timestamp":"1633402800.0"},{"content":"I guess the answer is D,E..","poster":"aiwaai","comment_id":"12608","upvote_count":"2","timestamp":"1632783180.0"},{"upvote_count":"1","content":"A & C are sure wrong since there is no resource type lamda in AWS managed rules. B is ok , but i will choose D E correct answers.","poster":"INASR","comments":[{"content":"BC or DE, anybody?","upvote_count":"1","timestamp":"1632471600.0","comment_id":"11075","poster":"duduga40"},{"timestamp":"1632781800.0","content":"You can’t link rule to lambda, however link it to a customized automation document to invoke a lambda could be achievable.","upvote_count":"1","poster":"EricJason","comment_id":"12071"}],"timestamp":"1632377220.0","comment_id":"10931"},{"content":"https://docs.aws.amazon.com/config/latest/developerguide/vpc-flow-logs-enabled.html\nAWS Config has a managed rule.","comment_id":"10620","comments":[{"comment_id":"10662","poster":"duduga40","upvote_count":"1","content":"BC or CD?","timestamp":"1632352380.0"}],"upvote_count":"1","poster":"mojoa","timestamp":"1632219240.0"},{"comments":[{"upvote_count":"2","timestamp":"1632169380.0","poster":"duduga40","content":"Anybody?","comment_id":"10481","comments":[{"upvote_count":"1","comment_id":"11351","content":"BC or DE, anybody?","poster":"duduga40","timestamp":"1632754260.0"}]}],"upvote_count":"2","timestamp":"1632112620.0","content":"B and D, is right?","comment_id":"10085","poster":"duduga40"}]}],"exam":{"id":29,"lastUpdated":"11 Apr 2025","isBeta":false,"numberOfQuestions":509,"isMCOnly":false,"name":"AWS Certified Security - Specialty","provider":"Amazon","isImplemented":true},"currentPage":2},"__N_SSP":true}